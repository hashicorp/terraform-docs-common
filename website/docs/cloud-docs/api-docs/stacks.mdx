---
page_title: Stacks - API Docs - HCP Terraform
description: >-
  Use these endpoints to manage and interact with stacks.
tfc_only: true
---

[200]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/200

[201]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/201

[202]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/202

[204]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/204

[400]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

[401]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/401

[403]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403

[404]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

[409]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/409

[412]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/412

[422]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/422

[429]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429

[500]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500

[504]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/504

[JSON API document]: /terraform/cloud-docs/api-docs#json-api-documents

[JSON API error object]: http://jsonapi.org/format/#error-objects

# Stacks API

Stacks represent collections of components, replicated across one or more deployments.

## Overview

The scope of the API includes the following endpoints:

| Method   | Path                                       | Action                                                      |
|----------|--------------------------------------------|-------------------------------------------------------------|
| `POST`   | `/stacks`                                  | Call this endpoint to [create a stack](#create-a-stack).    |
| `GET`    | `/organizations/:organization_name/stacks` | Call this endpoint to [list existing stacks](#list-stacks). |
| `GET`    | `/stacks/:stack_id`                        | Call this endpoint to [show a stack](#show-a-stack).        |
| `PATCH`  | `/stacks/:stack_id`                        | Call this endpoint to [update a stack](#update-a-stack).    |
| `DELETE` | `/stacks/:stack_id`                        | Call this endpoint to [delete a stack](#delete-stack).      |

## Create a stack

This endpoint creates a stack for an organization.

`POST /stacks`

-> **Note:** Stack create access is restricted to users who maintain the specified project, the owners team, teams with the "Manage all projects" permission, and the [organization API token](/terraform/cloud-docs/users-teams-organizations/api-tokens#organization-api-tokens).

### Request Body

This POST endpoint requires a JSON object with the following properties as a request payload.

Properties without a default value are required.

| Key path                                       | Type    | Default          | Description                                                                                                                                                                                                                                   |
|------------------------------------------------|---------|------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `data.attributes.name`                         | string  |                  | The name of the stack, which can only include letters, numbers, `-`, and `_`. This will be used as an identifier and must be unique in the project.                                                                                           |
| `data.attributes.description`                  | string  | (nothing)        | A description for the stack.                                                                                                                                                                                                                  |
| `data.attributes.speculative-enabled`          | boolean | `false`          | Whether this stack allows automatic [speculative plans][]. Setting this to `false` prevents HCP Terraform from running plans on pull requests, which can improve security if the VCS repository is public or includes untrusted contributors. |
| `data.attributes.locked`                       | boolean | `false`          | Whether this stack is locked. A lock prevents HCP Terraform from initiating any new runs that would modify the infrastructure managed by the stack.                                                                                           |
| `data.attributes.lock-reason`                  | string  | (nothing)        | Specifies why the stack is locked.                                                                                                                                                                                                            |
| `data.attributes.vcs-repo`                     | object  |                  | Settings for the stack's VCS repository.                                                                                                                                                                                                      |
| `data.attributes.vcs-repo.branch`              | string  | (nothing)        | The repository branch used by this stack's configuration. If omitted or submitted as an empty string, this defaults to the repository's default branch (e.g. `main`).                                                                         |
| `data.attributes.vcs-repo.tags-regex`          | string  | (previous value) | A regular expression used to match Git tags. HCP Terraform begins preparing a stack configuration when this value is present and a VCS event occurs that contains a matching Git tag for the regular expression.                              |
| `data.attributes.vcs-repo.identifier`          | string  |                  | A reference to your VCS repository in the format :org/:repo where :org and :repo refer to the organization and repository in your VCS provider.                                                                                               |
| `data.attributes.vcs-repo.display-identifier`  | string  | (nothing)        | The display identifier for the stack's VCS repository. For most VCS providers outside of BitBucket Cloud and Azure DevOps, this will match the identifier string.                                                                             |
| `data.attributes.vcs-repo.repository-http-url` | string  |                  | The HTTP URL for the repository.                                                                                                                                                                                                              |
| `data.attributes.service-provider`             | string  |                  | The VCS provider being connected with. Valid options are `"github"`, `"github_enterprise"`, `"gitlab_hosted"`, `"gitlab_community_edition"`, `"gitlab_enterprise_edition"`, or `"ado_server"`.                                                |
| `data.attributes.trigger-disabled`             | boolean |                  | When disabled, plan operations won't automatically start.                                                                                                                                                                                     |
| `data.attributes.vcs-repo.oauth-token-id`      | string  |                  | The VCS Connection (OAuth Connection + Token) to use. This ID can be obtained from the [oauth-tokens](/terraform/cloud-docs/api-docs/oauth-tokens) endpoint.                                                                                  |
| `data.relationships.project.data.id`           | string  |                  | The ID of the project to create the stack in. You must have permission to manage the project, either by organization-level permissions or team admin access to a specific project.                                                            |

| Status  | Response                  | Reason                                                                |
|---------|---------------------------|-----------------------------------------------------------------------|
| [201][] | [JSON API document][]     | Successfully created a stack.                                         |
| [404][] | [JSON API error object][] | Not found, or the user is unauthorized to perform this action.        |
| [422][] | [JSON API error object][] | Malformed request body (e.g., missing attributes, wrong types, etc.). |
| [500][] | [JSON API error object][] | Internal system failure.                                              |

### Sample Payload

```json
{
  "data": {
    "attributes": {
      "vcs-repo": {
        "identifier": "my-organization/basic-stack",
        "display-identifier": "my-organization/basic-stack",
        "oauth-token-id": "ot-hmAyP66qk2AMVdbJ",
        "branch": "",
        "service-provider": "github",
        "repository-http-url": "https://github.com/my-organization/basic-stack",
        "trigger-disabled": false
      },
      "name": "basic-stack",
      "description": "Example stack for documentation",
      "locked"  : false,
      "lock-reason": "",
      "speculative-enabled": false
    },
    "relationships": {
      "project": {
        "data": {
          "type": "projects",
          "id": "prj-jT92VLSFpv8FwKtc"
        }
      }
    }
  }
}

```

### Sample Request

```shell
$ curl\
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  --request POST \
  --data @payload.json \
  https://app.terraform.io/api/v2/stacks
```

### Sample Response

```json
{
  "data": {
    "id": "st-8owEfTCMQShdQ8Lb",
    "type": "stacks",
    "attributes": {
      "name": "basic-stack",
      "description": "Example stack for documentation",
      "speculative-enabled": false,
      "locked": false,
      "lock-reason": "",
      "linked-stack-connections": {
        "upstream-count": 0,
        "downstream-count": 0,
        "inputs-count": 0,
        "outputs-count": 0
      },
      "vcs-repo": {
        "branch": "",
        "identifier": "my-organization/basic-stack",
        "display-identifier": "my-organization/basic-stack",
        "oauth-token-id": "ot-hmAyP66qk2AMVdbJ",
        "repository-http-url": "https://github.com/my-organization/basic-stack",
        "service-provider": "github",
        "trigger-disabled": false,
        "tags-regex": ""
      },
      "created-at": "2025-05-09T21:25:37.504Z",
      "updated-at": "2025-05-09T21:25:37.504Z"
    },
    "relationships": {
      "project": {
        "data": {
          "id": "prj-AeuWVcVZVFGFgSbk",
          "type": "projects"
        }
      }
    },
    "links": {
      "self": "/api/v2/stacks/st-8owEfTCMQShdQ8Lb",
      "stack-configurations": "/api/v2/stacks/st-8owEfTCMQShdQ8Lb/stack-configurations",
      "stack-deployments": "/api/v2/stacks/st-8owEfTCMQShdQ8Lb/stack-deployments"
    }
  }
}
```

## List stacks

This endpoint lists stacks in the organization.

`GET /organizations/:organization_name/stacks`

-> **Note:** Stack read access is restricted to users or teams with read project access and the [organization API token](/terraform/cloud-docs/users-teams-organizations/api-tokens#organization-api-tokens).

| Parameter            | Description                                         |
|----------------------|-----------------------------------------------------|
| `:organization_name` | The name of the organization to list the stacks of. |

### Query Parameters

This endpoint supports pagination [with standard URL query parameters](/terraform/cloud-docs/api-docs#query-parameters); remember to percent-encode `[` as `%5B` and `]` as `%5D` if your tooling doesn't automatically encode URLs.

| Parameter      | Description                                                                                                                                                                                                                                                                               |
|----------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `page[number]` | **Optional.** If omitted, the endpoint will return the first page.                                                                                                                                                                                                                        |
| `page[size]`   | **Optional.** If omitted, the endpoint will return 20 policy sets per page.                                                                                                                                                                                                               |
| `sort`         | **Optional.** Allows sorting the returned stacks. Valid values are "name" and "created-at". Prepending a hyphen to the sort parameter reverses the order. For example, `"-name"` sorts by name in reverse alphabetical order. If omitted, the default sort order is arbitrary but stable. |

### Sample Request

```shell
$ curl\
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  https://app.terraform.io/api/v2/organizations/my-organization/stacks
```

### Sample Response

```json
{
  "data": [
    {
      "id": "st-LSqektntTNJrAhCt",
      "type": "stacks",
      "attributes": {
        "name": "pet-nulls-stack",
        "description": null,
        "speculative-enabled": false,
        "locked": false,
        "lock-reason": "",
        "linked-stack-connections": {
          "upstream-count": 0,
          "downstream-count": 0,
          "inputs-count": 0,
          "outputs-count": 0
        },
        "vcs-repo": {
          "branch": "",
          "tags-regex": "",
          "identifier": "hashicorp-guides/pet-nulls-stack",
          "display-identifier": "hashicorp-guides/pet-nulls-stack",
          "oauth-token-id": "ot-t3remoFJPeuLk1Mz",
          "repository-http-url": "https://github.com/hashicorp-guides/pet-nulls-stack",
          "service-provider": "github",
          "trigger-disabled": false
        },
        "created-at": "2025-05-09T15:19:42.478Z",
        "updated-at": "2025-05-09T22:53:04.324Z"
      },
      "links": {
        "self": "/api/v2/stacks/st-LSqektntTNJrAhCt",
        "stack-configurations": "/api/v2/stacks/st-LSqektntTNJrAhCt/stack-configurations",
        "stack-deployments": "/api/v2/stacks/st-LSqektntTNJrAhCt/stack-deployments"
      },
      "relationships": {
        "project": {
          "data": {
            "id": "prj-18PG93QyqCMhLhWT",
            "type": "projects"
          }
        }
      }
    }
  ],
  "links": {
    "self": "https://app.terraform.io/api/v2/organizations/hashicorp/stacks?page%5Bnumber%5D=1&page%5Bsize%5D=20",
    "first": "https://app.terraform.io/api/v2/organizations/hashicorp/stacks?page%5Bnumber%5D=1&page%5Bsize%5D=20",
    "prev": null,
    "next": null,
    "last": "https://app.terraform.io/api/v2/organizations/hashicorp/stacks?page%5Bnumber%5D=1&page%5Bsize%5D=20"
  },
  "meta": {
    "pagination": {
      "current-page": 1,
      "page-size": 20,
      "prev-page": null,
      "next-page": null,
      "total-pages": 1,
      "total-count": 1
    }
  }
}
```

## Show a Stack
`GET /stacks/:stack_id`

This endpoint returns details of the specified stack.

-> **Note:** Stack read access is restricted to users or teams with read project access and the [organization API token](/terraform/cloud-docs/users-teams-organizations/api-tokens#organization-api-tokens).

| Parameter   | Description   |
|-------------|---------------|
| `:stack_id` | The stack id. |

### Sample Request

```shell
$ curl\
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  https://app.terraform.io/api/v2/stacks/st-LSqektntTNJrAhCt
```

### Sample Response
```json
{
  "data": {
    "id": "st-LSqektntTNJrAhCt",
    "type": "stacks",
    "attributes": {
      "name": "pns",
      "description": "This stack contains the pet-nulls-stack example",
      "speculative-enabled": false,
      "locked": false,
      "lock-reason": "",
      "linked-stack-connections": {
        "upstream-count": 0,
        "downstream-count": 0,
        "inputs-count": 0,
        "outputs-count": 0
      },
      "vcs-repo": {
        "branch": "",
        "tags-regex": "",
        "identifier": "hashicorp/pet-nulls-stack",
        "display-identifier": "hashicorp/pet-nulls-stack",
        "oauth-token-id": "ot-t3remoFJPeuLk1Mz",
        "repository-http-url": "https://github.com/hashicorp/pet-nulls-stack",
        "service-provider": "github",
        "trigger-disabled": false
      },
      "created-at": "2025-05-09T15:19:42.478Z",
      "updated-at": "2025-05-09T21:15:47.727Z"
    },
    "relationships": {
      "project": {
        "data": {
            "id": "prj-18PG93QyqCMhLhWT",
            "type": "projects"
        }
      }
    },
    "links": {
      "self": "/api/v2/stacks/st-LSqektntTNJrAhCt",
      "stack-configurations": "/api/v2/stacks/st-LSqektntTNJrAhCt/stack-configurations",
      "stack-deployments": "/api/v2/stacks/st-LSqektntTNJrAhCt/stack-deployments"
    }
  }
}
```
## Update a Stack

`PATCH /stacks/:stack_id`

This endpoint updates the specified Stack.

| Parameter   | Description   |
|-------------|---------------|
| `:stack_id` | The stack id. |

### Request Body
This endpoint requires a JSON object with the following properties as a request payload.

Properties without a default value are required.

| Key path                                       | Type    | Default          | Description                                                                                                                                                                                                                                   |
|------------------------------------------------|---------|------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `data.attributes.name`                         | string  |                  | The name of the stack, which can only include letters, numbers, `-`, and `_`. This will be used as an identifier and must be unique in the project.                                                                                           |
| `data.attributes.description`                  | string  | (nothing)        | A description for the stack.                                                                                                                                                                                                                  |
| `data.attributes.speculative-enabled`          | boolean | `false`          | Whether this stack allows automatic [speculative plans][]. Setting this to `false` prevents HCP Terraform from running plans on pull requests, which can improve security if the VCS repository is public or includes untrusted contributors. |
| `data.attributes.locked`                       | boolean | `false`          | Whether this stack is locked. A lock prevents HCP Terraform from initiating any new deployments that would modify the infrastructure managed by the stack.                                                                                    |
| `data.attributes.lock-reason`                  | string  | (nothing)        | Specifies why the stack is locked.                                                                                                                                                                                                            |
| `data.attributes.vcs-repo`                     | object  |                  | Settings for the stack's VCS repository.                                                                                                                                                                                                      |
| `data.attributes.vcs-repo.branch`              | string  | (nothing)        | The repository branch used by this stack's configuration. If omitted or submitted as an empty string, this defaults to the repository's default branch (e.g. `main`).                                                                         |
| `data.attributes.vcs-repo.tags-regex`          | string  | (previous value) | A regular expression used to match Git tags. HCP Terraform begins preparing a stack configuration when this value is present and a VCS event occurs that contains a matching Git tag for the regular expression.                              |
| `data.attributes.vcs-repo.identifier`          | string  |                  | A reference to your VCS repository in the format :org/:repo where :org and :repo refer to the organization and repository in your VCS provider.                                                                                               |
| `data.attributes.vcs-repo.display-identifier`  | string  | (nothing)        | The display identifier for the stack's VCS repository. For most VCS providers outside of BitBucket Cloud and Azure DevOps, this will match the identifier string.                                                                             |
| `data.attributes.vcs-repo.repository-http-url` | string  |                  | The HTTP URL for the repository.                                                                                                                                                                                                              |
| `data.attributes.service-provider`             | string  |                  | The VCS provider being connected with. Valid options are `"github"`, `"github_enterprise"`, `"gitlab_hosted"`, `"gitlab_community_edition"`, `"gitlab_enterprise_edition"`, or `"ado_server"`.                                                |
| `data.attributes.trigger-disabled`             | boolean |                  | When disabled, plan operations won't automatically start.                                                                                                                                                                                     |
| `data.attributes.vcs-repo.oauth-token-id`      | string  |                  | The VCS Connection (OAuth Connection + Token) to use. This ID can be obtained from the [oauth-tokens](/terraform/cloud-docs/api-docs/oauth-tokens) endpoint.                                                                                  |
| `data.relationships.project.data.id`           | string  |                  | The ID of the project to create the stack in. You must have permission to manage the project, either by organization-level permissions or team admin access to a specific project.                                                            |

### Sample Payload
```json
{
  "data": {
    "attributes": {
      "vcs-repo": {
        "identifier": "hashicorp/pet-nulls-stack-local",
        "display-identifier": "hashicorp/pet-nulls-stack-local",
        "oauth-token-id": "ot-hmAyP66qk2AMVdbJ",
        "branch": "",
        "service-provider": "github",
        "repository-http-url":"https://github.com/hashicorp/pet-nulls-stack-local",
        "tags-regex": null,
        "trigger-disabled": false
      },
      "name": "pet-nulls-stack-local",
      "description": "testing patch",
      "locked"  : false,
      "lock-reason": "",
      "speculative-enabled": false
    }
  }
}
```
### Sample Request

```shell
$ curl\
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  --request PATCH \
  https://app.terraform.io/api/v2/stacks/st-EJyw2MktbRjdsg96
```

### Sample Response
```json
{
  "data": {
    "id": "st-EJyw2MktbRjdsg96",
    "type": "stacks",
    "attributes": {
      "name": "pet-nulls-stack-local",
      "description": "testing patch",
      "locked"  : false,
      "lock-reason": "",
      "linked-stack-connections": {
        "upstream-count": 0,
        "downstream-count": 0,
        "inputs-count": 0,
        "outputs-count": 0
      },
      "speculative-enabled": false,
      "vcs-repo": {
        "branch": "",
        "tags-regex": null,
        "identifier": "hashicorp/pet-nulls-stack-local",
        "display-identifier": "hashicorp/pet-nulls-stack-local",
        "oauth-token-id": "ot-t3remoFJPeuLk1Mz",
        "repository-http-url": "https://github.com/hashicorp/pet-nulls-stack-local",
        "service-provider": "github",
        "trigger-disabled": false
      },
      "created-at": "2025-05-09T16:40:31.255Z",
      "updated-at": "2025-05-09T20:24:47.324Z"
    },
    "relationships": {
      "project": {
        "data": {
          "id": "prj-18PG93QyqCMhLhWT",
          "type": "projects"
        }
      }
    },
    "links": {
      "self": "/api/v2/stacks/st-EJyw2MktbRjdsg96",
      "stack-configurations": "/api/v2/stacks/st-EJyw2MktbRjdsg96/stack-configurations",
      "stack-deployments": "/api/v2/stacks/st-EJyw2MktbRjdsg96/stack-deployments"
    }
  }
}
```

## Delete a Stack

`DELETE /stacks/:stack_id`

This endpoint deletes the specified Stack.

| Parameter   | Description                                                                                                                                           |
|-------------|-------------------------------------------------------------------------------------------------------------------------------------------------------|
| `:stack_id` | The ID of the stack to delete. Refer to [List Stacks](/terraform/cloud-docs/api-docs/stacks#list-stacks) for reference information about finding IDs. |

| Status  | Response                  | Reason                                                  |
|---------|---------------------------|---------------------------------------------------------|
| [204][] | No Content                | Successfully deleted the stack                          |
| [404][] | [JSON API error object][] | Stack not found, or user unauthorized to perform action |

### Sample Request

```shell
curl \
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  --request DELETE \
  https://app.terraform.io/api/v2/stacks/st-EJyw2MktbRjdsg96
```