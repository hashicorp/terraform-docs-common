---
page_title: Workspaces - API Docs - HCP Terraform
description: >-
  Use the `/workspaces` endpoint to interact with workspaces. List, show, create, update, lock, unlock, and delete a workspace, and manage SSH keys, remote state consumers, and tags using the HTTP API.
---

[200]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/200

[201]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/201

[202]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/202

[204]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/204

[400]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

[401]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/401

[403]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403

[404]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

[409]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/409

[412]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/412

[422]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/422

[429]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429

[500]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500

[504]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/504

[JSON API document]: /terraform/cloud-docs/api-docs#json-api-documents

[JSON API error object]: https://jsonapi.org/format/#error-objects

[speculative plans]: /terraform/cloud-docs/run/remote-operations#speculative-plans

# Workspaces API

Workspaces represent running infrastructure managed by Terraform.

Viewing a workspace (individually or in a list) requires permission to read runs. Changing settings and force-unlocking require admin access to the workspace. Locking and unlocking a workspace requires permission to lock and unlock the workspace. ([More about permissions.](/terraform/cloud-docs/users-teams-organizations/permissions))

[permissions-citation]: #intentionally-unused---keep-for-maintainers

## Create a Workspace

`POST /organizations/:organization_name/workspaces`

| Parameter            | Description                                                                                                                                                              |
| -------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `:organization_name` | The name of the organization to create the workspace in. The organization must already exist in the system, and the user must have permissions to create new workspaces. |

-> **Note:** Workspace creation is restricted to the owners team, teams with the "Manage all workspaces" permission, teams with the "Manage all projects" permission, and the [organization API token](/terraform/cloud-docs/users-teams-organizations/api-tokens#organization-api-tokens).

### Request Body

This POST endpoint requires a JSON object with the following properties as a request payload.

Properties without a default value are required.

By supplying the necessary attributes under a `vcs-repository` object, you can create a workspace that is configured against a VCS Repository.

| Key path                                        | Type    | Default   | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|-------------------------------------------------|---------|-----------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `data.type`                                     | string  |           | Must be `"workspaces"`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| `data.attributes.name`                          | string  |           | The name of the workspace, which can only include letters, numbers, `-`, and `_`. This will be used as an identifier and must be unique in the organization.                                                                                                                                                                                                                                                                                                                                                    |
| `data.attributes.agent-pool-id`                 | string  | (nothing) | Required when `execution-mode` is set to `agent`. The ID of the agent pool belonging to the workspace's organization. This value must not be specified if `execution-mode` is set to `remote` or `local` or if `operations` is set to `true`.                                                                                                                                                                                                                                                                   |
| `data.attributes.allow-destroy-plan`            | boolean | `true`    | Whether destroy plans can be queued on the workspace.                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| `data.attributes.assessments-enabled`           | boolean | `false`   | (previously `drift-detection`) Whether or not HCP Terraform performs health assessments for the workspace. May be overriden by the organization setting `assessments-enforced`. Only available for Plus tier organizations, in workspaces running Terraform version 0.15.4+ and operating in [Remote execution mode](/terraform/cloud-docs/workspaces/settings#execution-mode).                                                                                                                               |
| `data.attributes.auto-apply`                    | boolean | `false`   | Whether to automatically apply changes when a Terraform plan is successful in runs initiated by VCS, UI or CLI, [with some exceptions](/terraform/cloud-docs/workspaces/settings#auto-apply-and-manual-apply).                                                                                                                                                                                                                                                                                                  |
| `data.attributes.auto-apply-run-trigger`        | boolean | `false`   | Whether to automatically apply changes when a Terraform plan is successful in runs initiated by run triggers.                                                                                                                                                                                                                                                                                                   |
| `data.attributes.auto-destroy-at`               | string  | (nothing) | Timestamp when the next scheduled destroy run will occur, refer to [Scheduled Destroy](/terraform/cloud-docs/workspaces/settings/deletion#automatically-destroy).                                                                                                                                                                                                                                                                                                                                               |
| `data.attributes.auto-destroy-activity-duration`| string  | (nothing) | Value and units for [automatically scheduled destroy runs based on workspace activity](/terraform/cloud-docs/workspaces/settings/deletion#automatically-destroy). Valid values are greater than 0 and four digits or less. Valid units are `d` and `h`. For example, to queue destroy runs after fourteen days of inactivity set `auto-destroy-activity-duration: "14d"`.                                                                                                                                       |
| `data.attributes.description`                   | string  | (nothing) | A description for the workspace.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| `data.attributes.execution-mode`                | string  | (nothing) | Which [execution mode](/terraform/cloud-docs/workspaces/settings#execution-mode) to use. Valid values are `remote`, `local`, and `agent`. When set to `local`, the workspace will be used for state storage only. This value _must not_ be specified if `operations` is specified, and _must_ be specified if `setting-overwrites.execution-mode` is set to `true`.                                                                                                                                             |
| `data.attributes.file-triggers-enabled`          | boolean | `true`    | Whether to filter runs based on the changed files in a VCS push. If enabled, it uses either `trigger-prefixes` in conjunction with `working_directory` or `trigger-patterns` to describe the set of changed files that will start a run. If disabled, any push will trigger a run.                                                                                                                                                                                                                              |
| `data.attributes.global-remote-state`           | boolean | `false`   | Whether the workspace should allow all workspaces in the organization to [access its state data](/terraform/cloud-docs/workspaces/state) during runs. If `false`, then only specifically approved workspaces can access its state. Manage allowed workspaces using the [Remote State Consumers](/terraform/cloud-docs/api-docs/workspaces#get-remote-state-consumers) endpoints, documented later on this page. **Note:** Terraform Enterprise admins can choose the default value for new workspaces if this attribute is omitted. |
| `data.attributes.operations`                    | boolean | `true`    | **DEPRECATED** Use `execution-mode` instead. Whether to use remote execution mode. When set to `false`, the workspace will be used for state storage only. This value must not be specified if `execution-mode` is specified.                                                                                                                                                                                                                                                                                   |
| `data.attributes.queue-all-runs`                | boolean | `false`   | Whether runs should be queued immediately after workspace creation. When set to false, runs triggered by a VCS change will not be queued until at least one run is manually queued.                                                                                                                                                                                                                                                                                                                             |
| `data.attributes.source-name`                   | string  | (nothing) | A friendly name for the application or client creating this workspace. If set, this will be displayed on the workspace as "Created via `<SOURCE NAME>`".                                                                                                                                                                                                                                                                                                                                                        |
| `data.attributes.source-url`                    | string  | (nothing) | A URL for the application or client creating this workspace. This can be the URL of a related resource in another app, or a link to documentation or other info about the client.                                                                                                                                                                                                                                                                                                                               |
| `data.attributes.speculative-enabled`           | boolean | true      | Whether this workspace allows automatic [speculative plans][]. Setting this to `false` prevents HCP Terraform from running plans on pull requests, which can improve security if the VCS repository is public or includes untrusted contributors. It doesn't prevent manual speculative plans via the CLI or the runs API.                                                                                                                                                                                    |
| `data.attributes.terraform-version`             | string  | (special) | The version of Terraform to use for this workspace. This can be either an exact version or a [version constraint](/terraform/language/expressions/version-constraints) (like `~> 1.0.0`); if you specify a constraint, the workspace will always use the newest release that meets that constraint. If omitted when creating a workspace, this defaults to the latest released version.                                                                                                                         |
| `data.attributes.trigger-patterns`              | array   | `[]`      | List of glob patterns that describe the files HCP Terraform monitors for changes. Trigger patterns are always appended to the root directory of the repository.                                                                                                                                                                                                                                                                                                                                               |
| `data.attributes.trigger-prefixes`               | array   | `[]`      | List of trigger prefixes that describe the paths HCP Terraform monitors for changes, in addition to the working directory. Trigger prefixes are always appended to the root directory of the repository. HCP Terraform will start a run when files are changed in any directory path matching the provided set of prefixes.                                                                                                                                                                                 |
| `data.attributes.vcs-repo.branch`               | string  | (nothing) | The repository branch that Terraform will execute from. If omitted or submitted as an empty string, this defaults to the repository's default branch (e.g. `master`) .                                                                                                                                                                                                                                                                                                                                          |
| `data.attributes.vcs-repo.identifier`            | string  |           | A reference to your VCS repository in the format :org/:repo where :org and :repo refer to the organization and repository in your VCS provider. The format for Azure DevOps is `:org/:project/_git/:repo`.                                                                                                                                                                                                                                                                                                      |
| `data.attributes.vcs-repo.ingress-submodules`   | boolean | `false`   | Whether submodules should be fetched when cloning the VCS repository.                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| `data.attributes.vcs-repo.oauth-token-id`       | string  |           | The VCS Connection (OAuth Connection + Token) to use. This ID can be obtained from the [oauth-tokens](/terraform/cloud-docs/api-docs/oauth-tokens) endpoint.                                                                                                                                                                                                                                                                                                                                                    |
| `data.attributes.vcs-repo.tags-regex`           | string  | (nothing) | A regular expression used to match Git tags. HCP Terraform triggers a run when this value is present and a VCS event occurs that contains a matching Git tag for the regular expression.                                                                                                                                                                                                                                                                                                                      |
| `data.attributes.vcs-repo`                      | object  | (nothing) | Settings for the workspace's VCS repository. If omitted, the workspace is created without a VCS repo. If included, you must specify at least the `oauth-token-id` and `identifier` keys below.                                                                                                                                                                                                                                                                                                                  |
| `data.attributes.working-directory`             | string  | (nothing) | A relative path that Terraform will execute within. This defaults to the root of your repository and is typically set to a subdirectory matching the environment when multiple environments exist within the same repository.                                                                                                                                                                                                                                                                                   |
| `data.attributes.setting-overwrites`            | object  |           |   The keys in this object are attributes that have organization-level defaults. Each attribute key stores a boolean value which is `true` by default. To overwrite the default inherited value, set an attribute's value to `false`. For example, to set `execution-mode` as the organization default, you set `setting-overwrites.execution-mode = false`.                        |
| `data.relationships.project.data.id`            | string  |           | The ID of the project to create the workspace in. If left blank, the workspace will be created in the organization's default project. You must have permission to create workspaces in the project, either by organization-level permissions or team admin access to a specific project.                                                                                                                                                                                                                        |

### Sample Payload

_Without a VCS repository_

```json
{
  "data": {
    "attributes": {
      "name": "workspace-1",
      "resource-count": 0,
      "updated-at": "2017-11-29T19:18:09.976Z"
    },
    "type": "workspaces"
  }
}
```

_With a VCS repository_

```json
{
  "data": {
    "attributes": {
      "name": "workspace-2",
      "resource-count": 0,
      "terraform_version": "0.11.1",
      "working-directory": "",
      "vcs-repo": {
        "identifier": "example/terraform-test-proj",
        "oauth-token-id": "ot-hmAyP66qk2AMVdbJ",
        "branch": "",
        "tags-regex": null
      },
      "updated-at": "2017-11-29T19:18:09.976Z"
    },
    "type": "workspaces"
  }
}
```
_Using Git Tags_

HCP Terraform triggers a run when you push a Git tag that matches the regular expression (SemVer): `1.2.3`, `22.33.44`, etc.

```json
{
  "data": {
    "attributes": {
      "name": "workspace-3",
      "resource-count": 0,
      "terraform_version": "0.12.1",
      "file-triggers-enabled": false,
      "working-directory": "/networking",
      "vcs-repo": {
        "identifier": "example/terraform-test-proj-monorepo",
        "oauth-token-id": "ot-hmAyP66qk2AMVdbJ",
        "branch": "",
        "tags-regex": "\d+.\d+.\d+"
      },
      "updated-at": "2017-11-29T19:18:09.976Z"
    },
    "type": "workspaces"
  }
}
```

_For a monorepo using trigger prefixes_

A run will be triggered in this workspace when changes are detected in any of the specified directories: `/networking`, `/modules`, or `/vendor`.

```json
{
  "data": {
    "attributes": {
      "name": "workspace-3",
      "resource-count": 0,
      "terraform_version": "0.12.1",
      "trigger-prefixes": ["/modules", "/vendor"],
      "working-directory": "/networking",
      "vcs-repo": {
        "identifier": "example/terraform-test-proj-monorepo",
        "oauth-token-id": "ot-hmAyP66qk2AMVdbJ",
        "branch": ""
      },
      "updated-at": "2017-11-29T19:18:09.976Z"
    },
    "type": "workspaces"
  }
}
```

_For a monorepo using trigger patterns_

A run will be triggered in this workspace when HCP Terraform detects any of the following changes:
- A file with the extension `tf` in any directory structure in which the last folder is named `networking` (e.g., `root/networking` and `root/module/networking`)
- Any file changed in the folder `/base`, no subfolders are included
- Any file changed in the folder `/submodule` and all of its subfolders

```json
{
  "data": {
    "attributes": {
      "name": "workspace-4",
      "resource-count": 0,
      "terraform_version": "1.2.2",
      "trigger-patterns": ["/**/networking/*.tf", "/base/*", "/submodule/**/*"],
      "vcs-repo": {
        "identifier": "example/terraform-test-proj-monorepo",
        "oauth-token-id": "ot-hmAyP66qk2AMVdbJ",
        "branch": ""
      },
      "updated-at": "2022-06-09T19:18:09.976Z"
    },
    "type": "workspaces"
  }
}
```

_Using HCP Terraform agents_

[HCP Terraform agents](/terraform/cloud-docs/api-docs/agents) allow HCP Terraform to communicate with isolated, private, or on-premises infrastructure.

```json
{
  "data": {
    "attributes": {
      "name":"workspace-1",
      "execution-mode": "agent",
      "agent-pool-id": "apool-ZjT6A7mVFm5WHT5a",
      "resource-count": 0,
      "updated-at": "2017-11-29T19:18:09.976Z"
    }
  },
  "type": "workspaces"
}
```

_Using an organization default execution mode_
```json
{
  "data": {
    "attributes": {
      "name":"workspace-with-default",
      "setting-overwrites": {
        "execution-mode": false
      }
    }
  },
  "type": "workspaces"
}
```

_With a project_

```json
{
  "data": {
    "type": "workspaces",
    "attributes": {
      "name": "workspace-in-project"
    },
    "relationships": {
      "project": {
        "data": {
          "type": "projects",
          "id": "prj-jT92VLSFpv8FwKtc"
        }
      }
    }
  }
}
```

### Sample Request

```shell
$ curl \
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  --request POST \
  --data @payload.json \
  https://app.terraform.io/api/v2/organizations/my-organization/workspaces
```

### Sample Response

_Without a VCS repository_

**Note:** The `assessments-enabled` property is only accepted by or returned from HCP Terraform.

```json
{
  "data": {
    "attributes": {
      "actions": {
        "is-destroyable": true
      },
      "allow-destroy-plan": true,
      "apply-duration-average": null,
      "auto-apply": false,
      "auto-apply-run-trigger": false,
      "auto-destroy-at": null,
      "auto-destroy-activity-duration": null,
      "created-at": "2021-08-16T21:22:49.566Z",
      "description": null,
      "environment": "default",
      "execution-mode": "agent",
      "file-triggers-enabled": true,
      "global-remote-state": false,
      "latest-change-at": "2021-08-16T21:22:49.566Z",
      "last-assessment-result-at" : "2021-08-17T21:20:12.908Z",
      "locked": false,
      "name": "workspace-1",
      "operations": true,
      "permissions": {
        "can-create-state-versions": true,
        "can-destroy": true,
        "can-force-unlock": true,
        "can-lock": true,
        "can-manage-run-tasks": true,
        "can-manage-tags": true,
        "can-queue-apply": true,
        "can-queue-destroy": true,
        "can-queue-run": true,
        "can-read-settings": true,
        "can-read-state-versions": true,
        "can-read-variable": true,
        "can-unlock": true,
        "can-update": true,
        "can-update-variable": true,
        "can-read-assessment-result": true,
        "can-force-delete" : true
      },
      "plan-duration-average": null,
      "policy-check-failures": null,
      "queue-all-runs": false,
      "resource-count": 0,
      "run-failures": null,
      "source": "tfe-api",
      "source-name": null,
      "source-url": null,
      "speculative-enabled": true,
      "structured-run-output-enabled": true,
      "terraform-version": "1.0.4",
      "trigger-prefixes": [],
      "updated-at": "2021-08-16T21:22:49.566Z",
      "vcs-repo": null,
      "vcs-repo-identifier": null,
      "working-directory": null,
      "workspace-kpis-runs-count": null,
      "assessments-enabled": false,
      "setting-overwrites": {
        "execution-mode": true,
        "agent-pool": true
      }
    },
    "id": "ws-6jrRyVDv1J8zQMB5",
    "links": {
      "self": "/api/v2/organizations/my-organization/workspaces/workspace-1"
    },
    "relationships": {
      "agent-pool": {
        "data": {
          "id": "apool-QxGd2tRjympfMvQc",
          "type": "agent-pools"
        }
      },
      "current-configuration-version": {
        "data": null
      },
      "current-run": {
        "data": null
      },
      "current-state-version": {
        "data": null
      },
      "current-assessment-result": {
        "data": null
      },
      "latest-run": {
        "data": null
      },
      "organization": {
        "data": {
          "id": "my-organization",
          "type": "organizations"
        }
      },
      "outputs": {
        "data": []
      },
      "readme": {
        "data": null
      },
      "remote-state-consumers": {
        "links": {
          "related": "/api/v2/workspaces/ws-6jrRyVDv1J8zQMB5/relationships/remote-state-consumers"
        }
      }
    },
    "type": "workspaces"
  }
}
```

_With a VCS repository_

**Note:** The `assessments-enabled` property is only acceppted by or returned from HCP Terraform.

```json
{
  "data": {
    "attributes": {
      "actions": {
        "is-destroyable": true
      },
      "allow-destroy-plan": true,
      "apply-duration-average": null,
      "auto-apply": false,
      "auto-apply-run-trigger": false,
      "auto-destroy-at": null,
      "auto-destroy-activity-duration": null,
      "created-at": "2021-08-16T21:50:58.726Z",
      "description": null,
      "environment": "default",
      "execution-mode": "remote",
      "file-triggers-enabled": true,
      "global-remote-state": false,
      "latest-change-at": "2021-08-16T21:50:58.726Z",
      "locked": false,
      "name": "workspace-2",
      "operations": true,
      "permissions": {
        "can-create-state-versions": true,
        "can-destroy": true,
        "can-force-unlock": true,
        "can-lock": true,
        "can-manage-run-tasks": true,
        "can-manage-tags": true,
        "can-queue-apply": true,
        "can-queue-destroy": true,
        "can-queue-run": true,
        "can-read-settings": true,
        "can-read-state-versions": true,
        "can-read-variable": true,
        "can-unlock": true,
        "can-update": true,
        "can-update-variable": true,
        "can-force-delete" : true
      },
      "plan-duration-average": null,
      "policy-check-failures": null,
      "queue-all-runs": false,
      "resource-count": 0,
      "run-failures": null,
      "source": "tfe-api",
      "source-name": null,
      "source-url": null,
      "speculative-enabled": true,
      "structured-run-output-enabled": true,
      "terraform-version": "0.11.1",
      "trigger-prefixes": [],
      "updated-at": "2021-08-16T21:50:58.726Z",
      "vcs-repo": {
        "branch": "",
        "display-identifier": "example/terraform-test-proj",
        "identifier": "example/terraform-test-proj",
        "ingress-submodules": false,
        "oauth-token-id": "ot-hmAyP66qk2AMVdbJ",
        "repository-http-url": "https://github.com/example/terraform-test-proj",
        "service-provider": "github",
        "tags-regex": null,
        "webhook-url": "https://app.terraform.io/webhooks/vcs/704ac743-df64-4b8e-b9a3-a4c5fe1bec87"
      },
      "vcs-repo-identifier": "example/terraform-test-proj",
      "working-directory": "",
      "workspace-kpis-runs-count": null,
      "assessments-enabled": false,
      "setting-overwrites": {
        "execution-mode": true,
        "agent-pool": true
      }
    },
    "id": "ws-KTuq99JSzgmDSvYj",
    "links": {
      "self": "/api/v2/organizations/my-organization/workspaces/workspace-2"
    },
    "relationships": {
      "agent-pool": {
        "data": null
      },
      "current-configuration-version": {
        "data": {
          "id": "cv-9WgU5LYoTq3rrnG6",
          "type": "configuration-versions"
        },
        "links": {
          "related": "/api/v2/configuration-versions/cv-9WgU5LYoTq3rrnG6"
        }
      },
      "current-run": {
        "data": null
      },
      "current-state-version": {
        "data": null
      },
      "latest-run": {
        "data": null
      },
      "organization": {
        "data": {
          "id": "my-organization",
          "type": "organizations"
        }
      },
      "outputs": {
        "data": []
      },
      "readme": {
        "data": null
      },
      "remote-state-consumers": {
        "links": {
          "related": "/api/v2/workspaces/ws-KTuq99JSzgmDSvYj/relationships/remote-state-consumers"
        }
      }
    },
    "type": "workspaces"
  }
}
```

_With a project_

```json
{
  "data": {
    "id": "ws-HRkJLSYWF97jucqQ",
    "type": "workspaces",
    "attributes": {
      "allow-destroy-plan": true,
      "auto-apply": false,
      "auto-apply-run-trigger": false,
      "auto-destroy-at": null,
      "auto-destroy-activity-duration": null,
      "created-at": "2022-12-05T20:57:13.829Z",
      "environment": "default",
      "locked": false,
      "name": "workspace-in-project",
      "queue-all-runs": false,
      "speculative-enabled": true,
      "structured-run-output-enabled": true,
      "terraform-version": "1.3.5",
      "working-directory": null,
      "global-remote-state": true,
      "updated-at": "2022-12-05T20:57:13.829Z",
      "resource-count": 0,
      "apply-duration-average": null,
      "plan-duration-average": null,
      "policy-check-failures": null,
      "run-failures": null,
      "workspace-kpis-runs-count": null,
      "latest-change-at": "2022-12-05T20:57:13.829Z",
      "operations": true,
      "execution-mode": "remote",
      "vcs-repo": null,
      "vcs-repo-identifier": null,
      "permissions": {
        "can-update": true,
        "can-destroy": true,
        "can-queue-run": true,
        "can-read-variable": true,
        "can-update-variable": true,
        "can-read-state-versions": true,
        "can-read-state-outputs": true,
        "can-create-state-versions": true,
        "can-queue-apply": true,
        "can-lock": true,
        "can-unlock": true,
        "can-force-unlock": true,
        "can-read-settings": true,
        "can-manage-tags": true,
        "can-manage-run-tasks": false,
        "can-force-delete": true,
        "can-manage-assessments": true,
        "can-read-assessment-results": true,
        "can-queue-destroy": true
      },
      "actions": {
        "is-destroyable": true
      },
      "description": null,
      "file-triggers-enabled": true,
      "trigger-prefixes": [],
      "trigger-patterns": [],
      "assessments-enabled": false,
      "last-assessment-result-at": null,
      "source": "tfe-api",
      "source-name": null,
      "source-url": null,
      "tag-names": [],
      "setting-overwrites": {
        "execution-mode": false,
        "agent-pool": false
      }
    },
    "relationships": {
      "organization": {
        "data": {
          "id": "my-organization",
          "type": "organizations"
        }
      },
      "current-run": {
        "data": null
      },
      "latest-run": {
        "data": null
      },
      "outputs": {
        "data": []
      },
      "remote-state-consumers": {
        "links": {
          "related": "/api/v2/workspaces/ws-HRkJLSYWF97jucqQ/relationships/remote-state-consumers"
        }
      },
      "current-state-version": {
        "data": null
      },
      "current-configuration-version": {
        "data": null
      },
      "agent-pool": {
        "data": null
      },
      "readme": {
        "data": null
      },
      "project": {
        "data": {
          "id": "prj-jT92VLSFpv8FwKtc",
          "type": "projects"
        }
      },
      "current-assessment-result": {
        "data": null
      },
      "vars": {
        "data": []
      }
    },
    "links": {
      "self": "/api/v2/organizations/my-organization/workspaces/workspace-in-project"
    }
  }
}
```

## Update a Workspace

A workspace can be updated via two endpoints, which behave identically. One refers to a workspace by its ID, and the other by its name and organization.

`PATCH /workspaces/:workspace_id`

| Parameter       | Description                       |
| --------------- | --------------------------------- |
| `:workspace_id` | The ID of the workspace to update |

`PATCH /organizations/:organization_name/workspaces/:name`

| Parameter            | Description                                                                                                                                                            |
| -------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `:organization_name` | The name of the organization the workspace belongs to.                                                                                                                 |
| `:name`              | The name of the workspace to update, which can only include letters, numbers, `-`, and `_`. This will be used as an identifier and must be unique in the organization. |

### Request Body

These PATCH endpoints require a JSON object with the following properties as a request payload.

Properties without a default value are required.

| Key path                                      | Type           | Default          | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|-----------------------------------------------|----------------|------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `data.type`                                   | string         |                  | Must be `"workspaces"`.                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| `data.attributes.name`                        | string         | (previous value) | A new name for the workspace, which can only include letters, numbers, `-`, and `_`. This will be used as an identifier and must be unique in the organization. **Warning:** Changing a workspace's name changes its URL in the API and UI.                                                                                                                                                                                                                                     |
| `data.attributes.agent-pool-id`               | string         | (previous value) | Required when `execution-mode` is set to `agent`. The ID of the agent pool belonging to the workspace's organization. This value must not be specified if `execution-mode` is set to `remote` or `local` or if `operations` is set to `true`.                                                                                                                                                                                                                                   |
| `data.attributes.allow-destroy-plan`          | boolean        | (previous value) | Whether destroy plans can be queued on the workspace.                                                                                                                                                                                                                                                                                                                                                                                                                           |
| `data.attributes.assessments-enabled`         | boolean        | `false`          | (previously `drift-detection`) Whether or not HCP Terraform performs health assessments for the workspace. May be overriden by the organization setting `assessments-enforced`. Only available for Plus tier organizations, in workspaces running Terraform version 0.15.4+ and operating in [Remote execution mode](/terraform/cloud-docs/workspaces/settings#execution-mode).                                                                                               |
| `data.attributes.auto-apply`                  | boolean        | (previous value) | Whether to automatically apply changes when a Terraform plan is successful in runs initiated by VCS, UI or CLI, [with some exceptions](/terraform/cloud-docs/workspaces/settings#auto-apply-and-manual-apply).                                                                                                                                                                                                                                                                                                      |
| `data.attributes.auto-apply-run-trigger`      | boolean        | (previous value) | Whether to automatically apply changes when a Terraform plan is successful in runs initiated by run triggers.                                                                                                                                                                                                                                                                                                    |
| `data.attributes.auto-destroy-at`             | string         | (previous value) | Timestamp when the next scheduled destroy run will occur, refer to [Scheduled Destroy](/terraform/cloud-docs/workspaces/settings/deletion#automatically-destroy).                                                                                                                                                                                                                                                                                                               |
| `data.attributes.auto-destroy-activity-duration`| string       | (previous value) | Value and units for [automatically scheduled destroy runs based on workspace activity](/terraform/cloud-docs/workspaces/settings/deletion#automatically-destroy). Valid values are greater than 0 and four digits or less. Valid units are `d` and `h`. For example, to queue destroy runs after fourteen days of inactivity set `auto-destroy-activity-duration: "14d"`.                                                                                                       |
| `data.attributes.description`                 | string         | (previous value) | A description for the workspace.                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| `data.attributes.execution-mode`              | string         | (previous value) | Which [execution mode](/terraform/cloud-docs/workspaces/settings#execution-mode) to use. Valid values are `remote`, `local`, and `agent`. When set to `local`, the workspace will be used for state storage only. This value _must not_ be specified if `operations` is specified, and _must_ be specified if `setting-overwrites.execution-mode` is set to `true`.                                                                                                                                                                                                |
| `data.attributes.file-triggers-enabled`       | boolean        | (previous value) | Whether to filter runs based on the changed files in a VCS push. If enabled, it uses either `trigger-prefixes` in conjunction with `working_directory` or `trigger-patterns` to describe the set of changed files that will start a run. If disabled, any push will trigger a run.                                                                                                                                                                                              |
| `data.attributes.global-remote-state`         | boolean        | (previous value) | Whether the workspace should allow all workspaces in the organization to [access its state data](/terraform/cloud-docs/workspaces/state) during runs. If `false`, then only specifically approved workspaces can access its state. Manage allowed workspaces using the [Remote State Consumers](/terraform/cloud-docs/api-docs/workspaces#get-remote-state-consumers) endpoints, documented later on this page.                                                                 |
| `data.attributes.operations`                  | boolean        | (previous value) | **DEPRECATED** Use `execution-mode` instead. Whether to use remote execution mode. When set to `false`, the workspace will be used for state storage only. This value must not be specified if `execution-mode` is specified.                                                                                                                                                                                                                                                   |
| `data.attributes.queue-all-runs`              | boolean        | (previous value) | Whether runs should be queued immediately after workspace creation. When set to false, runs triggered by a VCS change will not be queued until at least one run is manually queued.                                                                                                                                                                                                                                                                                             |
| `data.attributes.speculative-enabled`         | boolean        | (previous value) | Whether this workspace allows automatic [speculative plans][]. Setting this to `false` prevents HCP Terraform from running plans on pull requests, which can improve security if the VCS repository is public or includes untrusted contributors. It doesn't prevent manual speculative plans via the CLI or the runs API.                                                                                                                                                    |
| `data.attributes.terraform-version`           | string         | (previous value) | The version of Terraform to use for this workspace. This can be either an exact version or a [version constraint](/terraform/language/expressions/version-constraints) (like `~> 1.0.0`); if you specify a constraint, the workspace will always use the newest release that meets that constraint.                                                                                                                                                                             |
| `data.attributes.trigger-patterns`            | array          | (previous value) | List of glob patterns that describe the files HCP Terraform monitors for changes. Trigger patterns are always appended to the root directory of the repository.                                                                                                                                                                                                                                                                                                               |
| `data.attributes.trigger-prefixes`            | array          | (previous value) | List of trigger prefixes that describe the paths HCP Terraform monitors for changes, in addition to the working directory. Trigger prefixes are always appended to the root directory of the repository. HCP Terraform will start a run when files are changed in any directory path matching the provided set of prefixes.                                                                                                                                                 |
| `data.attributes.vcs-repo.branch`             | string         | (previous value) | The repository branch that Terraform will execute from.                                                                                                                                                                                                                                                                                                                                                                                                                         |
| `data.attributes.vcs-repo.identifier`         | string         | (previous value) | A reference to your VCS repository in the format :org/:repo where :org and :repo refer to the organization and repository in your VCS provider. The format for Azure DevOps is `:org/:project/_git/:repo`.                                                                                                                                                                                                                                                                      |
| `data.attributes.vcs-repo.ingress-submodules` | boolean        | (previous value) | Whether submodules should be fetched when cloning the VCS repository.                                                                                                                                                                                                                                                                                                                                                                                                           |
| `data.attributes.vcs-repo.oauth-token-id`     | string  |         | The VCS Connection (OAuth Connection + Token) to use as identified. Get this ID from the [oauth-tokens](/terraform/cloud-docs/api-docs/oauth-tokens) endpoint. You can not specify this value if `github-app-installation-id` is specified.                                                                                                                                                                                                                                                     |
| `data.attributes.vcs-repo.github-app-installation-id` | string |  | The VCS Connection GitHub App Installation to use. Find this ID on the account settings page. Requires previously authorizing the GitHub App and generating a user-to-server token. Manage the token from **Account Settings** within HCP Terraform. You can not specify this value if `oauth-token-id` is specified.                                                                                                                                                                               |
| `data.attributes.vcs-repo.tags-regex`         | string         | (previous value) | A regular expression used to match Git tags. HCP Terraform triggers a run when this value is present and a VCS event occurs that contains a matching Git tag for the regular expression.                                                                                                                                                                                                                                                                                      |
| `data.attributes.vcs-repo`                    | object or null | (previous value) | To delete a workspace's existing VCS repo, specify `null` instead of an object. To modify a workspace's existing VCS repo, include whichever of the keys below you wish to modify. To add a new VCS repo to a workspace that didn't previously have one, include at least the `oauth-token-id` and `identifier` keys.                                                                                                                                                           |
| `data.attributes.working-directory`           | string         | (previous value) | A relative path that Terraform will execute within. This defaults to the root of your repository and is typically set to a subdirectory matching the environment when multiple environments exist within the same repository.                                                                                                                                                                                                                                                   |
| `data.attributes.setting-overwrites`          | object  |      |  The keys in this object are attributes that have organization-level defaults. Each attribute key stores a boolean value which is `true` by default. To overwrite the default inherited value, set an attribute's value to `false`. For example, to set `execution-mode` as the organization default, you set `setting-overwrites.execution-mode = false`.       |
| `data.relationships.project.data.id`          | string         | (previous value) | The ID of the project to move the workspace to. If left blank or unchanged, the workspace will not be moved. You must have admin permissions on both the source project and destination project in order to move a workspace between projects.                                                                                                                                                                                                                                  |

### Sample Payload

```json
{
  "data": {
    "attributes": {
      "name": "workspace-2",
      "resource-count": 0,
      "terraform_version": "0.11.1",
      "working-directory": "",
      "vcs-repo": {
        "identifier": "example/terraform-test-proj",
        "branch": "",
        "ingress-submodules": false,
        "oauth-token-id": "ot-hmAyP66qk2AMVdbJ"
      },
      "updated-at": "2017-11-29T19:18:09.976Z"
    },
    "relationships": {
      "project": {
        "data": {
          "type": "projects",
          "id": "prj-7HWWPGY3fYxztELU"
        }
      }
    },
    "type": "workspaces"
  }
}
```

### Sample Request

```shell
$ curl \
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  --request PATCH \
  --data @payload.json \
  https://app.terraform.io/api/v2/organizations/my-organization/workspaces/workspace-2
```

### Sample Response

```json
{
  "data": {
    "attributes": {
      "actions": {
        "is-destroyable": true
      },
      "allow-destroy-plan": true,
      "apply-duration-average": null,
      "auto-apply": false,
      "auto-apply-run-trigger": false,
      "auto-destroy-at": null,
      "auto-destroy-activity-duration": null,
      "created-at": "2021-08-16T21:50:58.726Z",
      "description": null,
      "environment": "default",
      "execution-mode": "remote",
      "file-triggers-enabled": true,
      "global-remote-state": false,
      "latest-change-at": "2021-08-16T21:50:58.726Z",
      "locked": false,
      "name": "workspace-2",
      "operations": true,
      "permissions": {
        "can-create-state-versions": true,
        "can-destroy": true,
        "can-force-unlock": true,
        "can-lock": true,
        "can-manage-run-tasks": true,
        "can-manage-tags": true,
        "can-queue-apply": true,
        "can-queue-destroy": true,
        "can-queue-run": true,
        "can-read-settings": true,
        "can-read-state-versions": true,
        "can-read-variable": true,
        "can-unlock": true,
        "can-update": true,
        "can-update-variable": true,
        "can-force-delete" : true
      },
      "plan-duration-average": null,
      "policy-check-failures": null,
      "queue-all-runs": false,
      "resource-count": 0,
      "run-failures": null,
      "source": "tfe-api",
      "source-name": null,
      "source-url": null,
      "speculative-enabled": true,
      "structured-run-output-enabled": true,
      "terraform-version": "0.11.1",
      "trigger-prefixes": [],
      "updated-at": "2021-08-16T21:50:58.726Z",
      "vcs-repo": {
        "branch": "",
        "display-identifier": "example/terraform-test-proj",
        "identifier": "example/terraform-test-proj",
        "ingress-submodules": false,
        "oauth-token-id": "ot-hmAyP66qk2AMVdbJ",
        "repository-http-url": "https://github.com/example/terraform-test-proj",
        "service-provider": "github",
        "tags-regex": null,
        "webhook-url": "https://app.terraform.io/webhooks/vcs/704ac743-df64-4b8e-b9a3-a4c5fe1bec87"
      },
      "vcs-repo-identifier": "example/terraform-test-proj",
      "working-directory": "",
      "workspace-kpis-runs-count": null,
      "setting-overwrites": {
        "execution-mode": false,
        "agent-pool": false
      }
    },
    "id": "ws-KTuq99JSzgmDSvYj",
    "links": {
      "self": "/api/v2/organizations/my-organization/workspaces/workspace-2"
    },
    "relationships": {
      "agent-pool": {
        "data": null
      },
      "current-configuration-version": {
        "data": {
          "id": "cv-9WgU5LYoTq3rrnG6",
          "type": "configuration-versions"
        },
        "links": {
          "related": "/api/v2/configuration-versions/cv-9WgU5LYoTq3rrnG6"
        }
      },
      "current-run": {
        "data": null
      },
      "current-state-version": {
        "data": null
      },
      "latest-run": {
        "data": null
      },
      "organization": {
        "data": {
          "id": "my-organization",
          "type": "organizations"
        }
      },
      "outputs": {
        "data": []
      },
      "project": {
        "data": {
          "type": "projects",
          "id": "prj-7HWWPGY3fYxztELU"
        }
      },
      "readme": {
        "data": {
          "id": "227347",
          "type": "workspace-readme"
        }
      },
      "remote-state-consumers": {
        "links": {
          "related": "/api/v2/workspaces/ws-KTuq99JSzgmDSvYj/relationships/remote-state-consumers"
        }
      }
    },
    "type": "workspaces"
  }
}
```

## List workspaces

This endpoint lists workspaces in the organization.

`GET /organizations/:organization_name/workspaces`

| Parameter            | Description                                             |
| -------------------- | ------------------------------------------------------- |
| `:organization_name` | The name of the organization to list the workspaces of. |

### Query Parameters

This endpoint supports pagination [with standard URL query parameters](/terraform/cloud-docs/api-docs#query-parameters). Remember to percent-encode `[` as `%5B` and `]` as `%5D` if your tooling doesn't automatically encode URLs.

| Parameter                     | Description                                                                                                                                                                                                                                                                                                                                                                                                          |
|-------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `page[number]`                | **Optional.** If omitted, the endpoint will return the first page.                                                                                                                                                                                                                                                                                                                                                   |
| `page[size]`                  | **Optional.** If omitted, the endpoint will return 20 workspaces per page.                                                                                                                                                                                                                                                                                                                                           |
| `search[name]`                | **Optional.** If specified, restricts results to workspaces with a name that matches the search string using a fuzzy search.                                                                                                                                                                                                                                                                                         |
| `search[tags]`                | **Optional.** If specified, restricts results to workspaces with that tag. If multiple comma separated values are specified, results matching all of the tags are returned.                                                                                                                                                                                                                                          |
| `search[exclude-tags]`        | **Optional.** If specified, results exclude workspaces with that tag. If multiple comma separated values are specified, workspaces with tags matching any of the tags are excluded.                                                                                                                                                                                                                                  |
| `search[wildcard-name]`       | **Optional.** If specified, restricts results to workspaces with partial matching, using `*` on prefix, suffix, or both. For example, `search[wildcard-name]=*-prod` returns all workspaces ending in `-prod`, `search[wildcard-name]=prod-*` returns all workspaces beginning with `prod-`, and `search[wildcard-name]=*-prod-*` returns all workspaces with substring `-prod-` regardless of prefix and/or suffix. |
| `sort`                        | **Optional.** Allows sorting the organization's workspaces by a provided value. You can sort by `"name"`, `"current-run.created-at"` (the time of the current run), and `"latest-change-at"` (the creation time of the latest state version or the workspace itself if no state version exists). Prepending a hyphen to the sort parameter reverses the order. For example, `"-name"` sorts by name in reverse alphabetical order. If omitted, the default sort order is arbitrary but stable. |
| `filter[project][id]`         | **Optional.** If specified, restricts results to workspaces in the specific project.                                                                                                                                                                                                                                                                                                                                 |
| `filter[current-run][status]` | **Optional.** If specified, restricts results to workspaces that match the status of a current run.                                                                                                                                                                                                                                                                                                                  |

### Sample Request

```shell
$ curl \
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  https://app.terraform.io/api/v2/organizations/my-organization/workspaces
```

### Sample Response

```json
{
  "data": [
    {
      "attributes": {
        "actions": {
          "is-destroyable": true
        },
        "allow-destroy-plan": true,
        "apply-duration-average": null,
        "auto-apply": false,
        "auto-apply-run-trigger": false,
        "auto-destroy-at": null,
        "auto-destroy-activity-duration": null,
        "created-at": "2021-08-16T21:50:58.726Z",
        "description": null,
        "environment": "default",
        "execution-mode": "remote",
        "file-triggers-enabled": true,
        "global-remote-state": false,
        "latest-change-at": "2021-08-16T21:50:58.726Z",
        "locked": false,
        "name": "workspace-2",
        "operations": true,
        "permissions": {
          "can-create-state-versions": true,
          "can-destroy": true,
          "can-force-unlock": true,
          "can-lock": true,
          "can-manage-run-tasks": true,
          "can-manage-tags": true,
          "can-queue-apply": true,
          "can-queue-destroy": true,
          "can-queue-run": true,
          "can-read-settings": true,
          "can-read-state-versions": true,
          "can-read-variable": true,
          "can-unlock": true,
          "can-update": true,
          "can-update-variable": true,
          "can-force-delete": true
        },
        "plan-duration-average": null,
        "policy-check-failures": null,
        "queue-all-runs": false,
        "resource-count": 0,
        "run-failures": null,
        "source": "tfe-api",
        "source-name": null,
        "source-url": null,
        "speculative-enabled": true,
        "structured-run-output-enabled": true,
        "terraform-version": "0.11.1",
        "trigger-prefixes": [],
        "updated-at": "2021-08-16T21:50:58.726Z",
        "vcs-repo": {
          "branch": "",
          "display-identifier": "example/terraform-test-proj",
          "identifier": "example/terraform-test-proj",
          "ingress-submodules": false,
          "oauth-token-id": "ot-hmAyP66qk2AMVdbJ",
          "repository-http-url": "https://github.com/example/terraform-test-proj",
          "service-provider": "github",
          "tags-regex": null,
          "webhook-url": "https://app.terraform.io/webhooks/vcs/704ac743-df64-4b8e-b9a3-a4c5fe1bec87"
        },
        "vcs-repo-identifier": "example/terraform-test-proj",
        "working-directory": "",
        "workspace-kpis-runs-count": null,
        "setting-overwrites": {
          "execution-mode": false,
          "agent-pool": false
        }
      },
      "id": "ws-KTuq99JSzgmDSvYj",
      "links": {
        "self": "/api/v2/organizations/my-organization/workspaces/workspace-2"
      },
      "relationships": {
        "agent-pool": {
          "data": null
        },
        "current-configuration-version": {
          "data": {
            "id": "cv-9WgU5LYoTq3rrnG6",
            "type": "configuration-versions"
          },
          "links": {
            "related": "/api/v2/configuration-versions/cv-9WgU5LYoTq3rrnG6"
          }
        },
        "current-run": {
          "data": null
        },
        "current-state-version": {
          "data": null
        },
        "latest-run": {
          "data": null
        },
        "organization": {
          "data": {
            "id": "my-organization",
            "type": "organizations"
          }
        },
        "outputs": {
          "data": []
        },
        "readme": {
          "data": {
            "id": "227347",
            "type": "workspace-readme"
          }
        },
        "remote-state-consumers": {
          "links": {
            "related": "/api/v2/workspaces/ws-KTuq99JSzgmDSvYj/relationships/remote-state-consumers"
          }
        }
      },
      "type": "workspaces"
    },
    {
      "attributes": {
        "actions": {
          "is-destroyable": true
        },
        "allow-destroy-plan": true,
        "apply-duration-average": null,
        "auto-apply": false,
        "auto-apply-run-trigger": false,
        "auto-destroy-at": null,
        "auto-destroy-activity-duration": null,
        "created-at": "2021-08-16T21:22:49.566Z",
        "description": null,
        "environment": "default",
        "execution-mode": "agent",
        "file-triggers-enabled": true,
        "global-remote-state": false,
        "latest-change-at": "2021-08-16T21:22:49.566Z",
        "locked": false,
        "name": "workspace-1",
        "operations": true,
        "permissions": {
          "can-create-state-versions": true,
          "can-destroy": true,
          "can-force-unlock": true,
          "can-lock": true,
          "can-manage-run-tasks": true,
          "can-manage-tags": true,
          "can-queue-apply": true,
          "can-queue-destroy": true,
          "can-queue-run": true,
          "can-read-settings": true,
          "can-read-state-versions": true,
          "can-read-variable": true,
          "can-unlock": true,
          "can-update": true,
          "can-update-variable": true,
          "can-force-delete": true
        },
        "plan-duration-average": null,
        "policy-check-failures": null,
        "queue-all-runs": false,
        "resource-count": 0,
        "run-failures": null,
        "source": "tfe-api",
        "source-name": null,
        "source-url": null,
        "speculative-enabled": true,
        "structured-run-output-enabled": true,
        "terraform-version": "1.0.4",
        "trigger-prefixes": [],
        "updated-at": "2021-08-16T21:22:49.566Z",
        "vcs-repo": null,
        "vcs-repo-identifier": null,
        "working-directory": null,
        "workspace-kpis-runs-count": null,
        "setting-overwrites": {
          "execution-mode": true,
          "agent-pool": true
        }
      },
      "id": "ws-6jrRyVDv1J8zQMB5",
      "links": {
        "self": "/api/v2/organizations/my-organization/workspaces/workspace-1"
      },
      "relationships": {
        "agent-pool": {
          "data": {
            "id": "apool-QxGd2tRjympfMvQc",
            "type": "agent-pools"
          }
        },
        "current-configuration-version": {
          "data": null
        },
        "current-run": {
          "data": null
        },
        "current-state-version": {
          "data": null
        },
        "latest-run": {
          "data": null
        },
        "organization": {
          "data": {
            "id": "my-organization",
            "type": "organizations"
          }
        },
        "outputs": {
          "data": []
        },
        "readme": {
          "data": null
        },
        "remote-state-consumers": {
          "links": {
            "related": "/api/v2/workspaces/ws-6jrRyVDv1J8zQMB5/relationships/remote-state-consumers"
          }
        }
      },
      "type": "workspaces"
    }
  ]
}
```

## Show workspace

Details on a workspace can be retrieved from two endpoints, which behave identically.

One refers to a workspace by its ID:

`GET /workspaces/:workspace_id`

| Parameter       | Description      |
| --------------- | ---------------- |
| `:workspace_id` | The workspace ID |

The other refers to a workspace by its name and organization:

`GET /organizations/:organization_name/workspaces/:name`

| Parameter            | Description                                                                                           |
| -------------------- | ----------------------------------------------------------------------------------------------------- |
| `:organization_name` | The name of the organization the workspace belongs to.                                                |
| `:name`              | The name of the workspace to show details for, which can only include letters, numbers, `-`, and `_`. |

### Workspace performance attributes

The following attributes are helpful in determining the overall health and performance of your workspace configuration.  These metrics refer to the **past 30 runs that have either resulted in an error or successfully applied**.

| Parameter                                  | Type   | Description                                                                             |
| ------------------------------------------ | ------ | --------------------------------------------------------------------------------------- |
| `data.attributes.apply-duration-average`   | number | This is the average time runs spend in the **apply** phase, represented in milliseconds |
| `data.attributes.plan-duration-average`    | number | This is the average time runs spend in the **plan** phase, represented in milliseconds  |
| `data.attributes.policy-check-failures`    | number | Reports the number of run failures resulting from a policy check failure                |
| `data.attributes.run-failures`             | number | Reports the number of failed runs                                                       |
| `data.attributes.workspace-kpis-run-count` | number | Total number of runs taken into account by these metrics                                |

### Sample Request

```shell
$ curl \
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  https://app.terraform.io/api/v2/organizations/my-organization/workspaces/workspace-1
```

### Sample Response

```json
{
  "data": {
    "attributes": {
      "actions": {
        "is-destroyable": true
      },
      "allow-destroy-plan": true,
      "apply-duration-average": 158000,
      "auto-apply": false,
      "auto-apply-run-trigger": false,
      "auto-destroy-at": null,
      "auto-destroy-activity-duration": null,
      "created-at": "2021-06-03T17:50:20.307Z",
      "description": "An example workspace for documentation.",
      "environment": "default",
      "execution-mode": "remote",
      "file-triggers-enabled": true,
      "global-remote-state": false,
      "latest-change-at": "2021-06-23T17:50:48.815Z",
      "locked": false,
      "name": "workspace-1",
      "operations": true,
      "permissions": {
        "can-create-state-versions": true,
        "can-destroy": true,
        "can-force-unlock": true,
        "can-lock": true,
        "can-manage-run-tasks": true,
        "can-manage-tags": true,
        "can-queue-apply": true,
        "can-queue-destroy": true,
        "can-queue-run": true,
        "can-read-settings": true,
        "can-read-state-versions": true,
        "can-read-variable": true,
        "can-unlock": true,
        "can-update": true,
        "can-update-variable": true,
        "can-force-delete": true
      },
      "plan-duration-average": 20000,
      "policy-check-failures": null,
      "queue-all-runs": false,
      "resource-count": 0,
      "run-failures": 6,
      "source": "terraform",
      "source-name": null,
      "source-url": null,
      "speculative-enabled": true,
      "structured-run-output-enabled": false,
      "terraform-version": "0.15.3",
      "trigger-prefixes": [],
      "updated-at": "2021-08-16T18:54:06.874Z",
      "vcs-repo": null,
      "vcs-repo-identifier": null,
      "working-directory": null,
      "workspace-kpis-runs-count": 7,
      "setting-overwrites": {
        "execution-mode": true,
        "agent-pool": true
      }
    },
    "id": "ws-qPhan8kDLymzv2uS",
    "links": {
      "self": "/api/v2/organizations/my-organization/workspaces/workspace-1"
    },
    "relationships": {
      "agent-pool": {
        "data": {
          "id": "apool-QxGd2tRjympfMvQc",
          "type": "agent-pools"
        }
      },
      "current-configuration-version": {
        "data": {
          "id": "cv-sixaaRuRwutYg5fH",
          "type": "configuration-versions"
        },
        "links": {
          "related": "/api/v2/configuration-versions/cv-sixaaRuRwutYg5fH"
        }
      },
      "current-run": {
        "data": {
          "id": "run-UyCw2TDCmxtfdjmy",
          "type": "runs"
        },
        "links": {
          "related": "/api/v2/runs/run-UyCw2TDCmxtfdjmy"
        }
      },
      "current-state-version": {
        "data": {
          "id": "sv-TAjm2vFZqY396qY6",
          "type": "state-versions"
        },
        "links": {
          "related": "/api/v2/workspaces/ws-qPhan8kDLymzv2uS/current-state-version"
        }
      },
      "latest-run": {
        "data": {
          "id": "run-UyCw2TDCmxtfdjmy",
          "type": "runs"
        },
        "links": {
          "related": "/api/v2/runs/run-UyCw2TDCmxtfdjmy"
        }
      },
      "organization": {
        "data": {
          "id": "my-organization",
          "type": "organizations"
        }
      },
      "project": {
        "data": {
          "type": "projects",
          "id": "prj-7HWWPGY3fYxztELU"
        }
      },
      "outputs": {
        "data": []
      },
      "readme": {
        "data": {
          "id": "227247",
          "type": "workspace-readme"
        }
      },
      "remote-state-consumers": {
        "links": {
          "related": "/api/v2/workspaces/ws-qPhan8kDLymzv2uS/relationships/remote-state-consumers"
        }
      }
    },
    "type": "workspaces"
  }
}
```

## Safe Delete a workspace

When you delete an HCP Terraform workspace with resources, Terraform can no longer track or manage that infrastructure. During a safe delete, HCP Terraform only deletes the workspace if it is not managing resources.

You can safe delete a workspace using two endpoints that behave identically. The first endpoint identifies a workspace with the workspace ID, and the other identifies the workspace by its name and organization.

`POST /workspaces/:workspace_id/actions/safe-delete`

| Parameter       | Description                       |
| --------------- | --------------------------------- |
| `:workspace_id` | The ID of the workspace to delete. |

`POST /organizations/:organization_name/workspaces/:name/actions/safe-delete`

| Parameter            | Description                                                                                 |
| -------------------- | ------------------------------------------------------------------------------------------- |
| `:organization_name` | The name of the workspace's organization.                                      |
| `:name`              | The name of the workspace to delete, which can only include letters, numbers, `-`, and `_`. |

| Status  | Response                  | Reason(s)                                                             |
| ------- | --------------------------| --------------------------------------------------------------------- |
| [204][] | No Content                | Successfully deleted the workspace                                    |
| [404][] | [JSON API error object][] | Workspace not found, or user unauthorized to perform workspace delete |
| [409][] | [JSON API error object][] | Workspace is not safe to delete because it is managing resources                                       |

## Force Delete a workspace

During a force delete, HCP Terraform removes the specified workspace without checking whether it is managing resources. We recommend using the [safe delete endpoint](#safe-delete-a-workspace) instead, when possible.

!> **Warning:** Terraform cannot track or manage the workspace's infrastructure after deletion. We recommend [destroying the workspace's infrastructure](/terraform/cloud-docs/run/modes-and-options#destroy-mode) before you delete it.

By default, only organization owners can force delete workspaces. Organization owners can also update [organization's settings](/terraform/cloud-docs/users-teams organizations/organizations#general) to let workspace admins force delete their own workspaces.

You can use two endpoints to force delete a workspace, which behave identically. One endpoint identifies the workspace with its workspace ID and the other endpoint identifies the workspace with its name and organization.

`DELETE /workspaces/:workspace_id`

| Parameter       | Description                       |
| --------------- | --------------------------------- |
| `:workspace_id` | The ID of the workspace to delete |

`DELETE /organizations/:organization_name/workspaces/:name`

| Parameter            | Description                                                                                 |
| -------------------- | ------------------------------------------------------------------------------------------- |
| `:organization_name` | The name of the organization the workspace belongs to.                                      |
| `:name`              | The name of the workspace to delete, which can only include letters, numbers, `-`, and `_`. |

| Status  | Response                  | Reason(s)                                                             |
| ------- | --------------------------| --------------------------------------------------------------------- |
| [204][] | No Content                | Successfully deleted the workspace                                    |
| [403][] | [JSON API error object][] | Not authorized to perform a force delete on the workspace             |
| [404][] | [JSON API error object][] | Workspace not found, or user unauthorized to perform workspace delete |

### Sample Request

```shell
$ curl \
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  --request DELETE \
  https://app.terraform.io/api/v2/organizations/my-organization/workspaces/workspace-1
```

## Lock a workspace

This endpoint locks a workspace.

`POST /workspaces/:workspace_id/actions/lock`

| Parameter       | Description                                                                                                                                             |
| --------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `:workspace_id` | The workspace ID to lock. Obtain this from the [workspace settings](/terraform/cloud-docs/workspaces/settings) or the [Show Workspace](#show-workspace) endpoint. |

| Status  | Response                                     | Reason(s)                                                   |
| ------- | -------------------------------------------- | ----------------------------------------------------------- |
| [200][] | [JSON API document][] (`type: "workspaces"`) | Successfully locked the workspace                           |
| [404][] | [JSON API error object][]                    | Workspace not found, or user unauthorized to perform action |
| [409][] | [JSON API error object][]                    | Workspace already locked                                    |

### Request Body

This POST endpoint requires a JSON object with the following properties as a request payload.

Properties without a default value are required.

| Key path | Type   | Default | Description                           |
| -------- | ------ | ------- | ------------------------------------- |
| `reason` | string | `""`    | The reason for locking the workspace. |

### Sample Payload

```json
{
  "reason": "Locking workspace-1"
}
```

### Sample Request

```shell
$ curl \
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  --request POST \
  --data @payload.json \
  https://app.terraform.io/api/v2/workspaces/ws-SihZTyXKfNXUWuUa/actions/lock
```

### Sample Response

```json
{
  "data": {
    "attributes": {
      "actions": {
        "is-destroyable": true
      },
      "allow-destroy-plan": true,
      "apply-duration-average": null,
      "auto-apply": false,
      "auto-apply-run-trigger": false,
      "auto-destroy-at": null,
      "auto-destroy-activity-duration": null,
      "created-at": "2021-08-16T19:44:45.241Z",
      "description": "Example workspace for documentation.",
      "environment": "default",
      "execution-mode": "agent",
      "file-triggers-enabled": false,
      "global-remote-state": false,
      "latest-change-at": "2021-08-16T19:44:45.241Z",
      "locked": true,
      "name": "workspace-1",
      "operations": true,
      "permissions": {
        "can-create-state-versions": true,
        "can-destroy": true,
        "can-force-unlock": true,
        "can-lock": true,
        "can-manage-run-tasks": true,
        "can-manage-tags": true,
        "can-queue-apply": true,
        "can-queue-destroy": true,
        "can-queue-run": true,
        "can-read-settings": true,
        "can-read-state-versions": true,
        "can-read-variable": true,
        "can-unlock": true,
        "can-update": true,
        "can-update-variable": true,
        "can-force-delete" : true
      },
      "plan-duration-average": null,
      "policy-check-failures": null,
      "queue-all-runs": false,
      "resource-count": 0,
      "run-failures": null,
      "source": "tfe-ui",
      "source-name": null,
      "source-url": null,
      "speculative-enabled": false,
      "structured-run-output-enabled": true,
      "terraform-version": "1.0.4",
      "trigger-prefixes": [],
      "updated-at": "2021-08-16T22:39:15.912Z",
      "vcs-repo": {
        "branch": "",
        "display-identifier": "my-organization/my-repository",
        "identifier": "my-organization/my-repository",
        "ingress-submodules": false,
        "oauth-token-id": "ot-hmAyP66qk2AMVdbJ",
        "repository-http-url": "https://github.com/my-organization/my-repository",
        "service-provider": "github",
        "tags-regex": null,
        "webhook-url": "https://app.terraform.io/webhooks/vcs/704ac743-df64-4b8e-b9a3-a4c5fe1bec87"
      },
      "vcs-repo-identifier": "my-organization/my-repository",
      "working-directory": "",
      "workspace-kpis-runs-count": null,
      "setting-overwrites": {
        "execution-mode": true,
        "agent-pool": true
      }
    },
    "id": "ws-FFP9JcN4m6czSRBj",
    "links": {
      "self": "/api/v2/organizations/my-organization/workspaces/workspace-1"
    },
    "relationships": {
      "agent-pool": {
        "data": {
          "id": "apool-QxGd2tRjympfMvQc",
          "type": "agent-pools"
        }
      },
      "current-configuration-version": {
        "data": {
          "id": "cv-EpThx8RZdxt8a2mK",
          "type": "configuration-versions"
        },
        "links": {
          "related": "/api/v2/configuration-versions/cv-EpThx8RZdxt8a2mK"
        }
      },
      "current-run": {
        "data": {
          "id": "run-kWrpCVo79eTzmW7y",
          "type": "runs"
        },
        "links": {
          "related": "/api/v2/runs/run-kWrpCVo79eTzmW7y"
        }
      },
      "current-state-version": {
        "data": null
      },
      "latest-run": {
        "data": {
          "id": "run-kWrpCVo79eTzmW7y",
          "type": "runs"
        },
        "links": {
          "related": "/api/v2/runs/run-kWrpCVo79eTzmW7y"
        }
      },
      "locked-by": {
        "data": {
          "id": "user-mGUNNJBeTrTYgxmv",
          "type": "users"
        },
        "links": {
          "related": "/api/v2/users/user-mGUNNJBeTrTYgxmv"
        }
      },
      "organization": {
        "data": {
          "id": "my-organization",
          "type": "organizations"
        }
      },
      "outputs": {
        "data": []
      },
      "readme": {
        "data": {
          "id": "227247",
          "type": "workspace-readme"
        }
      },
      "remote-state-consumers": {
        "links": {
          "related": "/api/v2/workspaces/ws-FFP9JcN4m6czSRBj/relationships/remote-state-consumers"
        }
      }
    },
    "type": "workspaces"
  }
}
```

## Unlock a workspace

This endpoint unlocks a workspace. Unlocking a workspace sets the current state version to the latest finalized intermediate state version. If intermediate state versions are available, but HCP Terraform has not yet finalized the latest intermediate state version, the unlock will fail with a 503 response. For this particular error, it's recommended to retry the unlock operation for a short period of time until the platform finalizes the state version. If you must force-unlock a workspace under these conditions, ensure that state was saved successfully by inspecting the latest state version using the [State Version List API](/terraform/cloud-docs/api-docs/state-versions#list-state-versions-for-a-workspace)

`POST /workspaces/:workspace_id/actions/unlock`

| Parameter       | Description                                                                                                                                               |
| --------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `:workspace_id` | The workspace ID to unlock. Obtain this from the [workspace settings](/terraform/cloud-docs/workspaces/settings) or the [Show Workspace](#show-workspace) endpoint. |

| Status  | Response                                     | Reason(s)                                                   |
| ------- | -------------------------------------------- | ----------------------------------------------------------- |
| [200][] | [JSON API document][] (`type: "workspaces"`) | Successfully unlocked the workspace                         |
| [404][] | [JSON API error object][]                    | Workspace not found, or user unauthorized to perform action |
| [409][] | [JSON API error object][]                    | Workspace already unlocked, or locked by a different user   |

### Sample Request

```shell
$ curl \
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  --request POST \
  https://app.terraform.io/api/v2/workspaces/ws-SihZTyXKfNXUWuUa/actions/unlock
```

### Sample Response

```json
{
  "data": {
    "attributes": {
      "actions": {
        "is-destroyable": true
      },
      "allow-destroy-plan": true,
      "apply-duration-average": null,
      "auto-apply": false,
      "auto-apply-run-trigger": false,
      "auto-destroy-at": null,
      "auto-destroy-activity-duration": null,
      "created-at": "2021-08-16T19:44:45.241Z",
      "description": "Example workspace for documentation.",
      "environment": "default",
      "execution-mode": "agent",
      "file-triggers-enabled": false,
      "global-remote-state": false,
      "latest-change-at": "2021-08-16T19:44:45.241Z",
      "locked": false,
      "name": "workspace-1",
      "operations": true,
      "permissions": {
        "can-create-state-versions": true,
        "can-destroy": true,
        "can-force-unlock": true,
        "can-lock": true,
        "can-manage-run-tasks": true,
        "can-manage-tags": true,
        "can-queue-apply": true,
        "can-queue-destroy": true,
        "can-queue-run": true,
        "can-read-settings": true,
        "can-read-state-versions": true,
        "can-read-variable": true,
        "can-unlock": true,
        "can-update": true,
        "can-update-variable": true,
        "can-force-delete" : true
      },
      "plan-duration-average": null,
      "policy-check-failures": null,
      "queue-all-runs": false,
      "resource-count": 0,
      "run-failures": null,
      "source": "tfe-ui",
      "source-name": null,
      "source-url": null,
      "speculative-enabled": false,
      "structured-run-output-enabled": true,
      "terraform-version": "1.0.4",
      "trigger-prefixes": [],
      "updated-at": "2021-08-16T22:36:43.666Z",
      "vcs-repo": {
        "branch": "",
        "display-identifier": "my-organization/my-repository",
        "identifier": "my-organization/my-repository",
        "ingress-submodules": false,
        "oauth-token-id": "ot-hmAyP66qk2AMVdbJ",
        "repository-http-url": "https://github.com/my-organization/my-repository",
        "service-provider": "github",
        "tags-regex": null,
        "webhook-url": "https://app.terraform.io/webhooks/vcs/704ac743-df64-4b8e-b9a3-a4c5fe1bec87"
      },
      "vcs-repo-identifier": "my-organization/my-repository",
      "working-directory": "",
      "workspace-kpis-runs-count": null,
      "setting-overwrites": {
        "execution-mode": true,
        "agent-pool": true
      }
    },
    "id": "ws-FFP9JcN4m6czSRBj",
    "links": {
      "self": "/api/v2/organizations/my-organization/workspaces/workspace-1"
    },
    "relationships": {
      "agent-pool": {
        "data": {
          "id": "apool-QxGd2tRjympfMvQc",
          "type": "agent-pools"
        }
      },
      "current-configuration-version": {
        "data": {
          "id": "cv-EpThx8RZdxt8a2mK",
          "type": "configuration-versions"
        },
        "links": {
          "related": "/api/v2/configuration-versions/cv-EpThx8RZdxt8a2mK"
        }
      },
      "current-run": {
        "data": {
          "id": "run-kWrpCVo79eTzmW7y",
          "type": "runs"
        },
        "links": {
          "related": "/api/v2/runs/run-kWrpCVo79eTzmW7y"
        }
      },
      "current-state-version": {
        "data": null
      },
      "latest-run": {
        "data": {
          "id": "run-kWrpCVo79eTzmW7y",
          "type": "runs"
        },
        "links": {
          "related": "/api/v2/runs/run-kWrpCVo79eTzmW7y"
        }
      },
      "organization": {
        "data": {
          "id": "my-organization",
          "type": "organizations"
        }
      },
      "outputs": {
        "data": []
      },
      "readme": {
        "data": {
          "id": "227247",
          "type": "workspace-readme"
        }
      },
      "remote-state-consumers": {
        "links": {
          "related": "/api/v2/workspaces/ws-FFP9JcN4m6czSRBj/relationships/remote-state-consumers"
        }
      }
    },
    "type": "workspaces"
  }
}
```

## Force Unlock a workspace

This endpoint force unlocks a workspace. Only users with admin access are authorized to force unlock a workspace.

`POST /workspaces/:workspace_id/actions/force-unlock`

| Parameter       | Description                                                                                                                                                     |
| --------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `:workspace_id` | The workspace ID to force unlock. Obtain this from the [workspace settings](/terraform/cloud-docs/workspaces/settings) or the [Show Workspace](#show-workspace) endpoint. |

| Status  | Response                                     | Reason(s)                                                   |
| ------- | -------------------------------------------- | ----------------------------------------------------------- |
| [200][] | [JSON API document][] (`type: "workspaces"`) | Successfully force unlocked the workspace                   |
| [404][] | [JSON API error object][]                    | Workspace not found, or user unauthorized to perform action |
| [409][] | [JSON API error object][]                    | Workspace already unlocked                                  |

### Sample Request

```shell
$ curl \
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  --request POST \
  https://app.terraform.io/api/v2/workspaces/ws-SihZTyXKfNXUWuUa/actions/force-unlock
```

### Sample Response

```json
{
  "data": {
    "attributes": {
      "actions": {
        "is-destroyable": true
      },
      "allow-destroy-plan": true,
      "apply-duration-average": null,
      "auto-apply": false,
      "auto-apply-run-trigger": false,
      "auto-destroy-at": null,
      "auto-destroy-activity-duration": null,
      "created-at": "2021-08-16T19:44:45.241Z",
      "description": "Example workspace for documentation.",
      "environment": "default",
      "execution-mode": "agent",
      "file-triggers-enabled": false,
      "global-remote-state": false,
      "latest-change-at": "2021-08-16T19:44:45.241Z",
      "locked": false,
      "name": "workspace-1",
      "operations": true,
      "permissions": {
        "can-create-state-versions": true,
        "can-destroy": true,
        "can-force-unlock": true,
        "can-lock": true,
        "can-manage-run-tasks": true,
        "can-manage-tags": true,
        "can-queue-apply": true,
        "can-queue-destroy": true,
        "can-queue-run": true,
        "can-read-settings": true,
        "can-read-state-versions": true,
        "can-read-variable": true,
        "can-unlock": true,
        "can-update": true,
        "can-update-variable": true,
        "can-force-delete" : true
      },
      "plan-duration-average": null,
      "policy-check-failures": null,
      "queue-all-runs": false,
      "resource-count": 0,
      "run-failures": null,
      "source": "tfe-ui",
      "source-name": null,
      "source-url": null,
      "speculative-enabled": false,
      "structured-run-output-enabled": true,
      "terraform-version": "1.0.4",
      "trigger-prefixes": [],
      "updated-at": "2021-08-16T22:42:06.143Z",
      "vcs-repo": {
        "branch": "",
        "display-identifier": "my-organization/my-repository",
        "identifier": "my-organization/my-repository",
        "ingress-submodules": false,
        "oauth-token-id": "ot-hmAyP66qk2AMVdbJ",
        "repository-http-url": "https://github.com/my-organization/my-repository",
        "service-provider": "github",
        "tags-regex": null,
        "webhook-url": "https://app.terraform.io/webhooks/vcs/704ac743-df64-4b8e-b9a3-a4c5fe1bec87"
      },
      "vcs-repo-identifier": "my-organization/my-repository",
      "working-directory": "",
      "workspace-kpis-runs-count": null,
      "setting-overwrites": {
        "execution-mode": true,
        "agent-pool": true
      }
    },
    "id": "ws-FFP9JcN4m6czSRBj",
    "links": {
      "self": "/api/v2/organizations/my-organization/workspaces/workspace-1"
    },
    "relationships": {
      "agent-pool": {
        "data": {
          "id": "apool-QxGd2tRjympfMvQc",
          "type": "agent-pools"
        }
      },
      "current-configuration-version": {
        "data": {
          "id": "cv-EpThx8RZdxt8a2mK",
          "type": "configuration-versions"
        },
        "links": {
          "related": "/api/v2/configuration-versions/cv-EpThx8RZdxt8a2mK"
        }
      },
      "current-run": {
        "data": {
          "id": "run-kWrpCVo79eTzmW7y",
          "type": "runs"
        },
        "links": {
          "related": "/api/v2/runs/run-kWrpCVo79eTzmW7y"
        }
      },
      "current-state-version": {
        "data": null
      },
      "latest-run": {
        "data": {
          "id": "run-kWrpCVo79eTzmW7y",
          "type": "runs"
        },
        "links": {
          "related": "/api/v2/runs/run-kWrpCVo79eTzmW7y"
        }
      },
      "organization": {
        "data": {
          "id": "my-organization",
          "type": "organizations"
        }
      },
      "outputs": {
        "data": []
      },
      "readme": {
        "data": {
          "id": "227247",
          "type": "workspace-readme"
        }
      },
      "remote-state-consumers": {
        "links": {
          "related": "/api/v2/workspaces/ws-FFP9JcN4m6czSRBj/relationships/remote-state-consumers"
        }
      }
    },
    "type": "workspaces"
  }
}
```

## Assign an SSH key to a workspace

This endpoint assigns an SSH key to a workspace.

`PATCH /workspaces/:workspace_id/relationships/ssh-key`

| Parameter       | Description                                                                                                                                                              |
| --------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `:workspace_id` | The workspace ID to assign the SSH key to. Obtain this from the [workspace settings](/terraform/cloud-docs/workspaces/settings) or the [Show Workspace](#show-workspace) endpoint. |

### Request Body

This POST endpoint requires a JSON object with the following properties as a request payload.

Properties without a default value are required.

| Key path             | Type   | Default | Description                                                                                        |
| -------------------- | ------ | ------- | -------------------------------------------------------------------------------------------------- |
| `data.type`          | string |         | Must be `"workspaces"`.                                                                            |
| `data.attributes.id` | string |         | The SSH key ID to assign. Obtain this from the [ssh-keys](/terraform/cloud-docs/api-docs/ssh-keys) endpoint. |

#### Sample Payload

```json
{
  "data": {
    "attributes": {
      "id": "sshkey-GxrePWre1Ezug7aM"
    },
    "type": "workspaces"
  }
}
```

### Sample Request

```shell
$ curl \
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  --request PATCH \
  --data @payload.json \
  https://app.terraform.io/api/v2/workspaces/ws-SihZTyXKfNXUWuUa/relationships/ssh-key
```

### Sample Response

```json
{
  "data": {
    "attributes": {
      "actions": {
        "is-destroyable": true
      },
      "allow-destroy-plan": true,
      "apply-duration-average": null,
      "auto-apply": false,
      "auto-apply-run-trigger": false,
      "auto-destroy-at": null,
      "auto-destroy-activity-duration": null,
      "created-at": "2021-08-16T19:44:45.241Z",
      "description": "Example workspace for documentation.",
      "environment": "default",
      "execution-mode": "agent",
      "file-triggers-enabled": false,
      "global-remote-state": false,
      "latest-change-at": "2021-08-16T19:44:45.241Z",
      "locked": false,
      "name": "workspace-1",
      "operations": true,
      "permissions": {
        "can-create-state-versions": true,
        "can-destroy": true,
        "can-force-unlock": true,
        "can-lock": true,
        "can-manage-run-tasks": true,
        "can-manage-tags": true,
        "can-queue-apply": true,
        "can-queue-destroy": true,
        "can-queue-run": true,
        "can-read-settings": true,
        "can-read-state-versions": true,
        "can-read-variable": true,
        "can-unlock": true,
        "can-update": true,
        "can-update-variable": true,
        "can-force-delete" : true
      },
      "plan-duration-average": null,
      "policy-check-failures": null,
      "queue-all-runs": false,
      "resource-count": 0,
      "run-failures": null,
      "source": "tfe-ui",
      "source-name": null,
      "source-url": null,
      "speculative-enabled": false,
      "structured-run-output-enabled": true,
      "terraform-version": "1.0.4",
      "trigger-prefixes": [],
      "updated-at": "2021-08-16T22:59:56.631Z",
      "vcs-repo": {
        "branch": "",
        "display-identifier": "my-organization/my-repository",
        "identifier": "my-organization/my-repository",
        "ingress-submodules": false,
        "oauth-token-id": "ot-4ecWLF8W8gfxxNXP",
        "repository-http-url": "https://github.com/my-organization/my-repository",
        "service-provider": "github",
        "tags-regex": null,
        "webhook-url": "https://app.terraform.io/webhooks/vcs/704ac743-df64-4b8e-b9a3-a4c5fe1bec87"
      },
      "vcs-repo-identifier": "my-organization/my-repository",
      "working-directory": "",
      "workspace-kpis-runs-count": null,
      "setting-overwrites": {
        "execution-mode": true,
        "agent-pool": true
      }
    },
    "id": "ws-FFP9JcN4m6czSRBj",
    "links": {
      "self": "/api/v2/organizations/my-organization/workspaces/workspace-1"
    },
    "relationships": {
      "agent-pool": {
        "data": {
          "id": "apool-QxGd2tRjympfMvQc",
          "type": "agent-pools"
        }
      },
      "current-configuration-version": {
        "data": {
          "id": "cv-EpThx8RZdxt8a2mK",
          "type": "configuration-versions"
        },
        "links": {
          "related": "/api/v2/configuration-versions/cv-EpThx8RZdxt8a2mK"
        }
      },
      "current-run": {
        "data": {
          "id": "run-kWrpCVo79eTzmW7y",
          "type": "runs"
        },
        "links": {
          "related": "/api/v2/runs/run-kWrpCVo79eTzmW7y"
        }
      },
      "current-state-version": {
        "data": null
      },
      "latest-run": {
        "data": {
          "id": "run-kWrpCVo79eTzmW7y",
          "type": "runs"
        },
        "links": {
          "related": "/api/v2/runs/run-kWrpCVo79eTzmW7y"
        }
      },
      "organization": {
        "data": {
          "id": "my-organization",
          "type": "organizations"
        }
      },
      "outputs": {
        "data": []
      },
      "readme": {
        "data": {
          "id": "227247",
          "type": "workspace-readme"
        }
      },
      "remote-state-consumers": {
        "links": {
          "related": "/api/v2/workspaces/ws-FFP9JcN4m6czSRBj/relationships/remote-state-consumers"
        }
      },
      "ssh-key": {
        "data": {
          "id": "sshkey-WfPdX2GKwGkK5rsB",
          "type": "ssh-keys"
        },
        "links": {
          "related": "/api/v2/ssh-keys/sshkey-WfPdX2GKwGkK5rsB"
        }
      }
    },
    "type": "workspaces"
  }
}
```

## Unassign an SSH key from a workspace

This endpoint unassigns the currently assigned SSH key from a workspace.

`PATCH /workspaces/:workspace_id/relationships/ssh-key`

| Parameter       | Description                                                                                                                                                              |
| --------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `:workspace_id` | The workspace ID to assign the SSH key to. Obtain this from the [workspace settings](/terraform/cloud-docs/workspaces/settings) or the [Show Workspace](#show-workspace) endpoint. |

### Request Body

This POST endpoint requires a JSON object with the following properties as a request payload.

Properties without a default value are required.

| Key path             | Type   | Default | Description             |
| -------------------- | ------ | ------- | ----------------------- |
| `data.type`          | string |         | Must be `"workspaces"`. |
| `data.attributes.id` | string |         | Must be `null`.         |

### Sample Payload

```json
{
  "data": {
    "attributes": {
      "id": null
    },
    "type": "workspaces"
  }
}
```

### Sample Request

```shell
$ curl \
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  --request PATCH \
  --data @payload.json \
  https://app.terraform.io/api/v2/workspaces/ws-SihZTyXKfNXUWuUa/relationships/ssh-key
```

### Sample Response

```json
{
  "data": {
    "attributes": {
      "actions": {
        "is-destroyable": true
      },
      "allow-destroy-plan": true,
      "apply-duration-average": null,
      "auto-apply": false,
      "auto-apply-run-trigger": false,
      "auto-destroy-at": null,
      "auto-destroy-activity-duration": null,
      "created-at": "2021-08-16T19:44:45.241Z",
      "description": "Example workspace for documentation.",
      "environment": "default",
      "execution-mode": "agent",
      "file-triggers-enabled": false,
      "global-remote-state": false,
      "latest-change-at": "2021-08-16T19:44:45.241Z",
      "locked": false,
      "name": "workspace-1",
      "operations": true,
      "permissions": {
        "can-create-state-versions": true,
        "can-destroy": true,
        "can-force-unlock": true,
        "can-lock": true,
        "can-manage-run-tasks": true,
        "can-manage-tags": true,
        "can-queue-apply": true,
        "can-queue-destroy": true,
        "can-queue-run": true,
        "can-read-settings": true,
        "can-read-state-versions": true,
        "can-read-variable": true,
        "can-unlock": true,
        "can-update": true,
        "can-update-variable": true,
        "can-force-delete" : true
      },
      "plan-duration-average": null,
      "policy-check-failures": null,
      "queue-all-runs": false,
      "resource-count": 0,
      "run-failures": null,
      "source": "tfe-ui",
      "source-name": null,
      "source-url": null,
      "speculative-enabled": false,
      "structured-run-output-enabled": true,
      "terraform-version": "1.0.4",
      "trigger-prefixes": [],
      "updated-at": "2021-08-16T23:06:08.609Z",
      "vcs-repo": {
        "branch": "",
        "display-identifier": "my-organization/my-workspace",
        "identifier": "my-organization/my-workspace",
        "ingress-submodules": false,
        "oauth-token-id": "ot-4ecWLF8W8gfxxNXP",
        "repository-http-url": "https://github.com/my-organization/my-workspace",
        "service-provider": "github",
        "tags-regex": null,
        "webhook-url": "https://app.terraform.io/webhooks/vcs/704ac743-df64-4b8e-b9a3-a4c5fe1bec87"
      },
      "vcs-repo-identifier": "my-organization/my-workspace",
      "working-directory": "",
      "workspace-kpis-runs-count": null,
      "setting-overwrites": {
        "execution-mode": true,
        "agent-pool": true
      }
    },
    "id": "ws-FFP9JcN4m6czSRBj",
    "links": {
      "self": "/api/v2/organizations/my-organization/workspaces/workspace-1"
    },
    "relationships": {
      "agent-pool": {
        "data": {
          "id": "apool-QxGd2tRjympfMvQc",
          "type": "agent-pools"
        }
      },
      "current-configuration-version": {
        "data": {
          "id": "cv-EpThx8RZdxt8a2mK",
          "type": "configuration-versions"
        },
        "links": {
          "related": "/api/v2/configuration-versions/cv-EpThx8RZdxt8a2mK"
        }
      },
      "current-run": {
        "data": {
          "id": "run-kWrpCVo79eTzmW7y",
          "type": "runs"
        },
        "links": {
          "related": "/api/v2/runs/run-kWrpCVo79eTzmW7y"
        }
      },
      "current-state-version": {
        "data": null
      },
      "latest-run": {
        "data": {
          "id": "run-kWrpCVo79eTzmW7y",
          "type": "runs"
        },
        "links": {
          "related": "/api/v2/runs/run-kWrpCVo79eTzmW7y"
        }
      },
      "organization": {
        "data": {
          "id": "my-organization",
          "type": "organizations"
        }
      },
      "outputs": {
        "data": []
      },
      "readme": {
        "data": {
          "id": "227247",
          "type": "workspace-readme"
        }
      },
      "remote-state-consumers": {
        "links": {
          "related": "/api/v2/workspaces/ws-FFP9JcN4m6czSRBj/relationships/remote-state-consumers"
        }
      }
    },
    "type": "workspaces"
  }
}

```

## Get Remote State Consumers

`GET /workspaces/:workspace_id/relationships/remote-state-consumers`

| Parameter       | Description                                                                                                                                                                       |
| --------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `:workspace_id` | The workspace ID to get remote state consumers for. Obtain this from the [workspace settings](/terraform/cloud-docs/workspaces/settings) or the [Show Workspace](#show-workspace) endpoint. |

This endpoint retrieves the list of other workspaces that are allowed to access the given workspace's state during runs.

* If `global-remote-state` is set to false for the workspace, this will return the list of other workspaces that are specifically authorized to access the workspace's state.
* If `global-remote-state` is set to true, this will return a list of every workspace in the organization except for the subject workspace.

The list returned by this endpoint is subject to the caller's normal workspace permissions; it will not include workspaces that the provided API token is unable to read.

### Query Parameters

This endpoint supports pagination [with standard URL query parameters](/terraform/cloud-docs/api-docs#query-parameters). Remember to percent-encode `[` as `%5B` and `]` as `%5D` if your tooling doesn't automatically encode URLs.

| Parameter      | Description                                                                |
| -------------- | -------------------------------------------------------------------------- |
| `page[number]` | **Optional.** If omitted, the endpoint will return the first page.         |
| `page[size]`   | **Optional.** If omitted, the endpoint will return 20 workspaces per page. |

### Sample Request

```shell
$ curl \
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  https://app.terraform.io/api/v2/workspaces/ws-SihZTyXKfNXUWuUa/relationships/remote-state-consumers
```

### Sample Response

```json
{
  "data": [
    {
      "attributes": {
        "actions": {
          "is-destroyable": true
        },
        "allow-destroy-plan": true,
        "apply-duration-average": null,
        "auto-apply": false,
        "auto-apply-run-trigger": false,
        "auto-destroy-at": null,
        "auto-destroy-activity-duration": null,
        "created-at": "2021-08-16T21:50:58.726Z",
        "description": null,
        "environment": "default",
        "execution-mode": "remote",
        "file-triggers-enabled": true,
        "global-remote-state": false,
        "latest-change-at": "2021-08-16T21:50:58.726Z",
        "locked": false,
        "name": "workspace-2",
        "operations": true,
        "permissions": {
          "can-create-state-versions": true,
          "can-destroy": true,
          "can-force-unlock": true,
          "can-lock": true,
          "can-manage-run-tasks": true,
          "can-manage-tags": true,
          "can-queue-apply": true,
          "can-queue-destroy": true,
          "can-queue-run": true,
          "can-read-settings": true,
          "can-read-state-versions": true,
          "can-read-variable": true,
          "can-unlock": true,
          "can-update": true,
          "can-update-variable": true,
          "can-force-delete" : true
        },
        "plan-duration-average": null,
        "policy-check-failures": null,
        "queue-all-runs": false,
        "resource-count": 0,
        "run-failures": null,
        "source": "tfe-api",
        "source-name": null,
        "source-url": null,
        "speculative-enabled": true,
        "structured-run-output-enabled": true,
        "terraform-version": "0.11.1",
        "trigger-prefixes": [],
        "updated-at": "2021-08-16T22:57:28.163Z",
        "vcs-repo": {
          "branch": "",
          "display-identifier": "my-organization/my-workspace",
          "identifier": "my-organization/my-workspace",
          "ingress-submodules": false,
          "oauth-token-id": "ot-hmAyP66qk2AMVdbJ",
          "repository-http-url": "https://github.com/my-organization/my-workspace",
          "service-provider": "github",
          "tags-regex": null,
          "webhook-url": "https://app.terraform.io/webhooks/vcs/704ac743-df64-4b8e-b9a3-a4c5fe1bec87"
        },
        "vcs-repo-identifier": "my-organization/my-workspace",
        "working-directory": "",
        "workspace-kpis-runs-count": null,
        "setting-overwrites": {
          "execution-mode": false,
          "agent-pool": false
        }
      },
      "id": "ws-KTuq99JSzgmDSvYj",
      "links": {
        "self": "/api/v2/organizations/my-organization/workspaces/workspace-2"
      },
      "relationships": {
        "agent-pool": {
          "data": null
        },
        "current-configuration-version": {
          "data": {
            "id": "cv-9WgU5LYoTq3rrnG6",
            "type": "configuration-versions"
          },
          "links": {
            "related": "/api/v2/configuration-versions/cv-9WgU5LYoTq3rrnG6"
          }
        },
        "current-run": {
          "data": null
        },
        "current-state-version": {
          "data": null
        },
        "latest-run": {
          "data": null
        },
        "organization": {
          "data": {
            "id": "my-organization",
            "type": "organizations"
          }
        },
        "outputs": {
          "data": []
        },
        "readme": {
          "data": {
            "id": "227347",
            "type": "workspace-readme"
          }
        },
        "remote-state-consumers": {
          "links": {
            "related": "/api/v2/workspaces/ws-KTuq99JSzgmDSvYj/relationships/remote-state-consumers"
          }
        },
        "ssh-key": {
          "data": {
            "id": "sshkey-WfPdX2GKwGkK5rsB",
            "type": "ssh-keys"
          },
          "links": {
            "related": "/api/v2/ssh-keys/sshkey-WfPdX2GKwGkK5rsB"
          }
        }
      },
      "type": "workspaces"
    }
  ],
  "links": {
    "first": "https://app.terraform.io/api/v2/workspaces/ws-FFP9JcN4m6czSRBj/relationships/remote-state-consumers?page%5Bnumber%5D=1&page%5Bsize%5D=20",
    "last": "https://app.terraform.io/api/v2/workspaces/ws-FFP9JcN4m6czSRBj/relationships/remote-state-consumers?page%5Bnumber%5D=1&page%5Bsize%5D=20",
    "next": null,
    "prev": null,
    "self": "https://app.terraform.io/api/v2/workspaces/ws-FFP9JcN4m6czSRBj/relationships/remote-state-consumers?page%5Bnumber%5D=1&page%5Bsize%5D=20"
  },
  "meta": {
    "pagination": {
      "current-page": 1,
      "next-page": null,
      "page-size": 20,
      "prev-page": null,
      "total-count": 1,
      "total-pages": 1
    }
  }
}
```

## Replace Remote State Consumers

`PATCH /workspaces/:workspace_id/relationships/remote-state-consumers`

| Parameter       | Description                                                                                                                                                                           |
| --------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `:workspace_id` | The workspace ID to replace remote state consumers for. Obtain this from the [workspace settings](/terraform/cloud-docs/workspaces/settings) or the [Show Workspace](#show-workspace) endpoint. |

This endpoint updates the workspace's remote state consumers to be _exactly_ the list of workspaces specified in the payload. It can only be used for workspaces where `global-remote-state` is false.

This endpoint can only be used by teams with permission to manage workspaces for the entire organization only those who can _view_ the entire list of consumers can _replace_ the entire list. ([More about permissions.](/terraform/cloud-docs/users-teams-organizations/permissions)) Teams with admin permissions on specific workspaces can still modify remote state consumers for those workspaces, but must use the add (POST) and remove (DELETE) endpoints listed below instead of this PATCH endpoint.

[permissions-citation]: #intentionally-unused---keep-for-maintainers

| Status  | Response                  | Reason(s)                                                             |
| ------- | ------------------------- | --------------------------------------------------------------------- |
| [204][] | No Content                | Successfully updated remote state consumers                           |
| [404][] | [JSON API error object][] | Workspace not found, or user unauthorized to perform action           |
| [422][] | [JSON API error object][] | Problem with payload or request; details provided in the error object |

### Request Body

This PATCH endpoint requires a JSON object with the following properties as a request payload.

Properties without a default value are required.

| Key path      | Type   | Default | Description                                                 |
| ------------- | ------ | ------- | ----------------------------------------------------------- |
| `data[].type` | string |         | Must be `"workspaces"`.                                     |
| `data[].id`   | string |         | The ID of a workspace to be set as a remote state consumer. |

### Sample Payload

```json
{
  "data": [
    {
      "id": "ws-7aiqKYf6ejMFdtWS",
      "type": "workspaces"
    }
  ]
}
```

### Sample Request

```shell
$ curl \
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  --request PATCH \
  --data @payload.json \
  https://app.terraform.io/api/v2/workspaces/ws-UYv6RYM8fVhzeGG5/relationships/remote-state-consumers
```

### Response

No response body.

Status code `204`.

## Add Remote State Consumers

`POST /workspaces/:workspace_id/relationships/remote-state-consumers`

| Parameter       | Description                                                                                                                                                                       |
| --------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `:workspace_id` | The workspace ID to add remote state consumers for. Obtain this from the [workspace settings](/terraform/cloud-docs/workspaces/settings) or the [Show Workspace](#show-workspace) endpoint. |

This endpoint adds one or more remote state consumers to the workspace. It can only be used for workspaces where `global-remote-state` is false.

* The workspaces specified as consumers must be readable to the API token that makes the request.
* A workspace cannot be added as a consumer of itself. (A workspace can always read its own state, regardless of access settings.)
* You can safely add a consumer workspace that is already present; it will be ignored, and the rest of the consumers in the request will be processed normally.

| Status  | Response                  | Reason(s)                                                             |
| ------- | ------------------------- | --------------------------------------------------------------------- |
| [204][] | No Content                | Successfully updated remote state consumers                           |
| [404][] | [JSON API error object][] | Workspace not found, or user unauthorized to perform action           |
| [422][] | [JSON API error object][] | Problem with payload or request; details provided in the error object |

### Request Body

This POST endpoint requires a JSON object with the following properties as a request payload.

Properties without a default value are required.

| Key path      | Type   | Default | Description                                                 |
| ------------- | ------ | ------- | ----------------------------------------------------------- |
| `data[].type` | string |         | Must be `"workspaces"`.                                     |
| `data[].id`   | string |         | The ID of a workspace to be set as a remote state consumer. |

### Sample Payload

```json
{
  "data": [
    {
      "id": "ws-7aiqKYf6ejMFdtWS",
      "type": "workspaces"
    }
  ]
}
```

### Sample Request

```shell
$ curl \
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  --request POST \
  --data @payload.json \
  https://app.terraform.io/api/v2/workspaces/ws-UYv6RYM8fVhzeGG5/relationships/remote-state-consumers
```

### Response

No response body.

Status code `204`.

## Delete Remote State Consumers

`DELETE /workspaces/:workspace_id/relationships/remote-state-consumers`

| Parameter       | Description                                                                                                                                                                          |
| --------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `:workspace_id` | The workspace ID to remove remote state consumers for. Obtain this from the [workspace settings](/terraform/cloud-docs/workspaces/settings) or the [Show Workspace](#show-workspace) endpoint. |

This endpoint removes one or more remote state consumers from a workspace, according to the contents of the payload. It can only be used for workspaces where `global-remote-state` is false.

* The workspaces specified as consumers must be readable to the API token that makes the request.
* You can safely remove a consumer workspace that is already absent; it will be ignored, and the rest of the consumers in the request will be processed normally.

| Status  | Response                  | Reason(s)                                                             |
| ------- | ------------------------- | --------------------------------------------------------------------- |
| [204][] | No Content                | Successfully updated remote state consumers                           |
| [404][] | [JSON API error object][] | Workspace not found, or user unauthorized to perform action           |
| [422][] | [JSON API error object][] | Problem with payload or request; details provided in the error object |

### Request Body

This POST endpoint requires a JSON object with the following properties as a request payload.

Properties without a default value are required.

| Key path      | Type   | Default | Description                                                      |
| ------------- | ------ | ------- | ---------------------------------------------------------------- |
| `data[].type` | string |         | Must be `"workspaces"`.                                          |
| `data[].id`   | string |         | The ID of a workspace to remove from the remote state consumers. |

### Sample Payload

```json
{
  "data": [
    {
      "id": "ws-7aiqKYf6ejMFdtWS",
      "type": "workspaces"
    }
  ]
}
```

### Sample Request

```shell
$ curl \
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  --request DELETE \
  --data @payload.json \
  https://app.terraform.io/api/v2/workspaces/ws-UYv6RYM8fVhzeGG5/relationships/remote-state-consumers
```

### Response

No response body.

Status code `204`.

## Get Tags

`GET /workspaces/:workspace_id/relationships/tags`

| Parameter       | Description                                                                                                                                                       |
| --------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `:workspace_id` | The workspace ID to fetch tags for. Obtain this from the [workspace settings](/terraform/cloud-docs/workspaces/settings) or the [Show Workspace](#show-workspace) endpoint. |

This endpoint returns the tags that are currently associated to a workspace.

### Query Parameters

This endpoint supports pagination [with standard URL query parameters](/terraform/cloud-docs/api-docs#query-parameters). Remember to percent-encode `[` as `%5B` and `]` as `%5D` if your tooling doesn't automatically encode URLs.

| Parameter      | Description                                                                |
| -------------- | -------------------------------------------------------------------------- |
| `page[number]` | **Optional.** If omitted, the endpoint will return the first page.         |
| `page[size]`   | **Optional.** If omitted, the endpoint will return 20 workspaces per page. |

### Sample Request

```shell
$ curl \
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  https://app.terraform.io/api/v2/workspaces/workspace-2/relationships/tags
```

### Sample Response

```json
{
  "data": [
    {
      "id": "tag-1",
      "type": "tags",
      "attributes": {
        "name": "tag1",
        "created-at":  "2022-03-09T06:04:39.585Z",
        "instance-count": 1
      },
      "relationships": {
        "organization": {
          "data": {
            "id": "my-organization",
            "type": "organizations"
          }
        }
      }
    },
    {
      "id": "tag-2",
      "type": "tags",
      "attributes": {
        "name": "tag2",
        "created-at":  "2022-03-09T06:04:39.585Z",
        "instance-count": 2
      },
      "relationships": {
        "organization": {
          "data": {
            "id": "my-organization",
            "type": "organizations"
          }
        }
      }
    }
  ]
}
```

## Add tags to a workspace

This endpoints adds one or more tags to the workspace. The workspace must already exist, and any
tag element that supplies an `id` attribute must exist. If the `name` attribute is used, and no
matching organization tag exists with such name, a new one will be created.

Tags are subject to the following rules:

- Workspace tags or tags must be one or more characters, have a 255 character limit, and can include letters, numbers, colons, hyphens, and underscores.
- You can create tags for a workspace using the user interface or the API. After you create a tag, you can assign it to other workspaces in the same organization.
- You cannot create tags for a workspace using the CLI.
- You cannot set tags at the project level, so there is no tag inheritance from projects to workspaces.

`POST /workspaces/:workspace_id/relationships/tags`

| Parameter       | Description                                                                                                                                                    |
| --------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `:workspace_id` | The workspace ID to add tags to. Obtain this from the [workspace settings](/terraform/cloud-docs/workspaces/settings) or the [Show Workspace](#show-workspace) endpoint. |

| Status  | Response                  | Reason(s)                                                   |
| ------- | ------------------------- | ----------------------------------------------------------- |
| [204][] | No Content                | Successfully added tags to workspace                        |
| [404][] | [JSON API error object][] | Workspace not found, or user unauthorized to perform action |

### Request Body

This POST endpoint requires a JSON object with the following properties as a request payload.

It is important to note that `type`, as well as one of `id` _or_ `attributes.name` is required.

| Key path                 | Type   | Default | Description                 |
| ------------------------ | ------ | ------- | --------------------------- |
| `data[].type`            | string |         | Must be `"tags"`.           |
| `data[].id`              | string |         | The id of the tag to add.   |
| `data[].attributes.name` | string |         | The name of the tag to add. |

### Sample Payload

```json
{
  "data": [
    {
      "type": "tags",
      "attributes": {
        "name": "foo"
      }
    },
    {
      "type": "tags",
      "attributes": {
        "name": "bar"
      }
    }
  ]
}
```

### Sample Request

```shell
curl \
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  --request POST \
  --data @payload.json \
  https://app.terraform.io/api/v2/workspaces/workspace-2/relationships/tags
```

### Sample Response

No response body.

Status code `204`.

## Remove tags from workspace

This endpoint removes one or more tags from a workspace. The workspace must already exist, and tag
element that supplies an `id` attribute must exist. If the `name` attribute is used, and no matching
organization tag is found, no action will occur for that entry. Tags removed from all workspaces will be
removed from the organization-wide list.

`DELETE /workspaces/:workspace_id/relationships/tags`

| Parameter       | Description                                                                                                                                                         |
| --------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `:workspace_id` | The workspace ID to remove tags from. Obtain this from the [workspace settings](/terraform/cloud-docs/workspaces/settings) or the [Show Workspace](#show-workspace) endpoint. |

| Status  | Response                  | Reason(s)                                                   |
| ------- | ------------------------- | ----------------------------------------------------------- |
| [204][] | No Content                | Successfully removed tags to workspace                      |
| [404][] | [JSON API error object][] | Workspace not found, or user unauthorized to perform action |

### Request Body

This POST endpoint requires a JSON object with the following properties as a request payload.

It is important to note that `type`, as well as one of `id` _or_ `attributes.name` is required.

| Key path                 | Type   | Default | Description                    |
| ------------------------ | ------ | ------- | ------------------------------ |
| `data[].type`            | string |         | Must be `"tags"`.              |
| `data[].id`              | string |         | The id of the tag to remove.   |
| `data[].attributes.name` | string |         | The name of the tag to remove. |

### Sample Payload

```json
{
  "data": [
    {
      "type": "tags",
      "id": "tag-Yfha4YpPievQ8wJw"
    }
  ]
}
```

### Sample Request

```shell
curl \
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  --request DELETE \
  --data @payload.json \
  https://app.terraform.io/api/v2/workspaces/workspace-2/relationships/tags
```

### Sample Response

No response body.

Status code `204`.

## Show data retention policy

<EnterpriseAlert>
This endpoint is exclusive to Terraform Enterprise and is not available in HCP Terraform.
</EnterpriseAlert>

`GET /workspaces/:workspace_id/relationships/data-retention-policy`

| Parameter            | Description                                                         |
| ---------------------| --------------------------------------------------------------------|
| `:workspace_id`      | The ID of the workspace to show the data retention policy for. Obtain this from the [workspace settings](/terraform/enterprise/workspaces/settings) or by sending a `GET` request to the [`/workspaces`](#show-workspace) endpoint. |


This endpoint shows the data retention policy set explicitly on the workspace.
When no data retention policy is set for the workspace, the endpoint returns the default policy configured for the organization. Refer to [Data Retention Policies](/terraform/enterprise/workspaces/settings/deletion#data-retention-policies) for instructions on configuring data retention policies for workspaces.

Refer to [Data Retention Policy API](/terraform/enterprise/api-docs/data-retention-policies#show-data-retention-policy) in the Terraform Enterprise documentation for details.

## Create or update data retention policy

<EnterpriseAlert>
This endpoint is exclusive to Terraform Enterprise and is not available in HCP Terraform.
</EnterpriseAlert>

`POST /workspaces/:workspace_id/relationships/data-retention-policy`

| Parameter       | Description                                                                                                                                                         |
| --------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `:workspace_id` | The workspace ID to update the data retention policy for. Obtain this from the [workspace settings](/terraform/enterprise/workspaces/settings) or by sending a `GET` request to the [`/workspaces`](#show-workspace) endpoint. |

This endpoint creates a data retention policy for a workspace or updates the existing policy. 
Refer to [Data Retention Policies](/terraform/enterprise/workspaces/settings/deletion#data-retention-policies) for additional information.

Refer to [Data Retention Policy API](/terraform/enterprise/api-docs/data-retention-policies#create-or-update-data-retention-policy) in the Terraform Enterprise documentation for details.

## Remove data retention policy

<EnterpriseAlert>
This endpoint is exclusive to Terraform Enterprise and is not available in HCP Terraform.
</EnterpriseAlert>

`DELETE /workspaces/:workspace_id/relationships/data-retention-policy`

| Parameter       | Description                                                                                                                                                                          |
| --------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `:workspace_id` | The workspace ID to remove the data retenetion policy for. Obtain this from the [workspace settings](/terraform/enterprise/workspaces/settings) or by sending a `GET` request to the [`/workspaces`](#show-workspace) endpoint. |

This endpoint removes the data retention policy explicitly set on a workspace.
When no data retention policy is set for the workspace, the endpoint returns the default policy configured for the organization. Refer to [Data Retention Policies](/terraform/enterprise/users-teams-organizations/organizations#destruction-and-deletion) for instructions on configuring data retention policies for organizations.

Read more about [workspace data retention policies](/terraform/enterprise/workspaces/settings/deletion#data-retention-policies).

Refer to [Data Retention Policy API](/terraform/enterprise/api-docs/data-retention-policies#remove-data-retention-policy) in the Terraform Enterprise documentation for details.

## Available Related Resources

The GET endpoints above can optionally return related resources, if requested with [the `include` query parameter](/terraform/cloud-docs/api-docs#inclusion-of-related-resources). The following resource types are available:

* `current_configuration_version` - The last configuration this workspace received, excluding plan-only configurations. Terraform uses this configuration for new runs, unless you provide a different one.
* `current_configuration_version.ingress_attributes` - The commit information for the current configuration version.
* `current_run` - Additional information about the current run.
* `current_run.configuration_version` - The configuration used in the current run.
* `current_run.configuration_version.ingress_attributes` - The commit information used in the current run.
* `current_run.plan` - The plan used in the current run.
* `locked_by` - The user, team, or run responsible for locking the workspace, if the workspace is currently locked.
* `organization` - The full organization record.
* `outputs` - The outputs for the most recently applied run.
* `project` - The full project record.
* `readme` - The most recent workspace README.md.
